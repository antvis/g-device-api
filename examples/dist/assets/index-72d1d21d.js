(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var c=(e=>(e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.ALWAYS=519]="ALWAYS",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.GEQUAL=518]="GEQUAL",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",e[e.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",e[e.RGBA32F_EXT=34836]="RGBA32F_EXT",e[e.RGB32F_EXT=34837]="RGB32F_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",e[e.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.SRGB_EXT=35904]="SRGB_EXT",e[e.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",e[e.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",e[e.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",e[e.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",e[e.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",e[e.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",e[e.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",e[e.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",e[e.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",e[e.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",e[e.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",e[e.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",e[e.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",e[e.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",e[e.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",e[e.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",e[e.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",e[e.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",e[e.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",e[e.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",e[e.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",e[e.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",e[e.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",e[e.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",e[e.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",e[e.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",e[e.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",e[e.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",e[e.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",e[e.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",e[e.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",e[e.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",e[e.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",e[e.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",e[e.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",e[e.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",e[e.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e))(c||{}),D=(e=>(e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.RenderTarget=2]="RenderTarget",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.RenderPipeline=7]="RenderPipeline",e[e.ComputePipeline=8]="ComputePipeline",e[e.Readback=9]="Readback",e[e.QueryPool=10]="QueryPool",e))(D||{}),w=(e=>(e[e.NEVER=c.NEVER]="NEVER",e[e.LESS=c.LESS]="LESS",e[e.EQUAL=c.EQUAL]="EQUAL",e[e.LEQUAL=c.LEQUAL]="LEQUAL",e[e.GREATER=c.GREATER]="GREATER",e[e.NOTEQUAL=c.NOTEQUAL]="NOTEQUAL",e[e.GEQUAL=c.GEQUAL]="GEQUAL",e[e.ALWAYS=c.ALWAYS]="ALWAYS",e))(w||{}),st=(e=>(e[e.CCW=c.CCW]="CCW",e[e.CW=c.CW]="CW",e))(st||{}),Z=(e=>(e[e.NONE=0]="NONE",e[e.FRONT=1]="FRONT",e[e.BACK=2]="BACK",e[e.FRONT_AND_BACK=3]="FRONT_AND_BACK",e))(Z||{}),O=(e=>(e[e.ZERO=c.ZERO]="ZERO",e[e.ONE=c.ONE]="ONE",e[e.SRC=c.SRC_COLOR]="SRC",e[e.ONE_MINUS_SRC=c.ONE_MINUS_SRC_COLOR]="ONE_MINUS_SRC",e[e.DST=c.DST_COLOR]="DST",e[e.ONE_MINUS_DST=c.ONE_MINUS_DST_COLOR]="ONE_MINUS_DST",e[e.SRC_ALPHA=c.SRC_ALPHA]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=c.ONE_MINUS_SRC_ALPHA]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=c.DST_ALPHA]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=c.ONE_MINUS_DST_ALPHA]="ONE_MINUS_DST_ALPHA",e[e.CONST=c.CONSTANT_COLOR]="CONST",e[e.ONE_MINUS_CONSTANT=c.ONE_MINUS_CONSTANT_COLOR]="ONE_MINUS_CONSTANT",e[e.SRC_ALPHA_SATURATE=c.SRC_ALPHA_SATURATE]="SRC_ALPHA_SATURATE",e))(O||{}),X=(e=>(e[e.ADD=c.FUNC_ADD]="ADD",e[e.SUBSTRACT=c.FUNC_SUBTRACT]="SUBSTRACT",e[e.REVERSE_SUBSTRACT=c.FUNC_REVERSE_SUBTRACT]="REVERSE_SUBSTRACT",e[e.MIN=c.MIN]="MIN",e[e.MAX=c.MAX]="MAX",e))(X||{}),re=(e=>(e[e.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",e[e.REPEAT=1]="REPEAT",e[e.MIRRORED_REPEAT=2]="MIRRORED_REPEAT",e))(re||{}),Y=(e=>(e[e.POINT=0]="POINT",e[e.BILINEAR=1]="BILINEAR",e))(Y||{}),q=(e=>(e[e.NO_MIP=0]="NO_MIP",e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR",e))(q||{}),te=(e=>(e[e.POINTS=0]="POINTS",e[e.TRIANGLES=1]="TRIANGLES",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.LINES=3]="LINES",e[e.LINE_STRIP=4]="LINE_STRIP",e))(te||{}),M=(e=>(e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE",e))(M||{}),K=(e=>(e[e.STATIC=1]="STATIC",e[e.DYNAMIC=2]="DYNAMIC",e))(K||{}),$=(e=>(e[e.VERTEX=1]="VERTEX",e[e.INSTANCE=2]="INSTANCE",e))($||{}),P=(e=>(e[e.TEXTURE_2D=0]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=2]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP",e))(P||{}),x=(e=>(e[e.SAMPLED=1]="SAMPLED",e[e.RENDER_TARGET=2]="RENDER_TARGET",e))(x||{}),H=(e=>(e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e[e.RGB=7]="RGB",e[e.ALL=15]="ALL",e))(H||{}),Q=(e=>(e[e.KEEP=c.KEEP]="KEEP",e[e.ZERO=c.ZERO]="ZERO",e[e.REPLACE=c.REPLACE]="REPLACE",e[e.INVERT=c.INVERT]="INVERT",e[e.INCREMENT_CLAMP=c.INCR]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=c.DECR]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=c.INCR_WRAP]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=c.DECR_WRAP]="DECREMENT_WRAP",e))(Q||{}),k=(e=>(e[e.Float=0]="Float",e[e.Uint=1]="Uint",e[e.Sint=2]="Sint",e[e.Depth=3]="Depth",e))(k||{}),_t=(e=>(e[e.LOWER_LEFT=0]="LOWER_LEFT",e[e.UPPER_LEFT=1]="UPPER_LEFT",e))(_t||{}),Et=(e=>(e[e.NEGATIVE_ONE=0]="NEGATIVE_ONE",e[e.ZERO=1]="ZERO",e))(Et||{}),Nt=(e=>(e[e.OcclusionConservative=0]="OcclusionConservative",e))(Nt||{}),F=(e=>(e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=3]="U32",e[e.S8=4]="S8",e[e.S16=5]="S16",e[e.S32=6]="S32",e[e.F16=7]="F16",e[e.F32=8]="F32",e[e.BC1=65]="BC1",e[e.BC2=66]="BC2",e[e.BC3=67]="BC3",e[e.BC4_UNORM=68]="BC4_UNORM",e[e.BC4_SNORM=69]="BC4_SNORM",e[e.BC5_UNORM=70]="BC5_UNORM",e[e.BC5_SNORM=71]="BC5_SNORM",e[e.U16_PACKED_5551=97]="U16_PACKED_5551",e[e.U16_PACKED_565=98]="U16_PACKED_565",e[e.D24=129]="D24",e[e.D32F=130]="D32F",e[e.D24S8=131]="D24S8",e[e.D32FS8=132]="D32FS8",e))(F||{}),he=(e=>(e[e.R=1]="R",e[e.RG=2]="RG",e[e.RGB=3]="RGB",e[e.RGBA=4]="RGBA",e[e.A=5]="A",e))(he||{});var ge=(e=>(e[e.None=0]="None",e[e.Normalized=1]="Normalized",e[e.sRGB=2]="sRGB",e[e.Depth=4]="Depth",e[e.Stencil=8]="Stencil",e[e.RenderTarget=16]="RenderTarget",e))(ge||{});function I(e,t,r){return e<<16|t<<8|r}var h=(e=>(e[e.ALPHA=I(1,5,0)]="ALPHA",e[e.F16_R=I(7,1,0)]="F16_R",e[e.F16_RG=I(7,2,0)]="F16_RG",e[e.F16_RGB=I(7,3,0)]="F16_RGB",e[e.F16_RGBA=I(7,4,0)]="F16_RGBA",e[e.F32_R=I(8,1,0)]="F32_R",e[e.F32_RG=I(8,2,0)]="F32_RG",e[e.F32_RGB=I(8,3,0)]="F32_RGB",e[e.F32_RGBA=I(8,4,0)]="F32_RGBA",e[e.U8_R=I(1,1,0)]="U8_R",e[e.U8_R_NORM=I(1,1,1)]="U8_R_NORM",e[e.U8_RG=I(1,2,0)]="U8_RG",e[e.U8_RG_NORM=I(1,2,1)]="U8_RG_NORM",e[e.U8_RGB=I(1,3,0)]="U8_RGB",e[e.U8_RGB_NORM=I(1,3,1)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=I(1,3,3)]="U8_RGB_SRGB",e[e.U8_RGBA=I(1,4,0)]="U8_RGBA",e[e.U8_RGBA_NORM=I(1,4,1)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=I(1,4,3)]="U8_RGBA_SRGB",e[e.U16_R=I(2,1,0)]="U16_R",e[e.U16_R_NORM=I(2,1,1)]="U16_R_NORM",e[e.U16_RG_NORM=I(2,2,1)]="U16_RG_NORM",e[e.U16_RGBA_NORM=I(2,4,1)]="U16_RGBA_NORM",e[e.U16_RGB=I(2,3,0)]="U16_RGB",e[e.U32_R=I(3,1,0)]="U32_R",e[e.U32_RG=I(3,2,0)]="U32_RG",e[e.S8_R=I(4,1,0)]="S8_R",e[e.S8_R_NORM=I(4,1,1)]="S8_R_NORM",e[e.S8_RG_NORM=I(4,2,1)]="S8_RG_NORM",e[e.S8_RGB_NORM=I(4,3,1)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=I(4,4,1)]="S8_RGBA_NORM",e[e.S16_R=I(5,1,0)]="S16_R",e[e.S16_RG=I(5,2,0)]="S16_RG",e[e.S16_RG_NORM=I(5,2,1)]="S16_RG_NORM",e[e.S16_RGB_NORM=I(5,3,1)]="S16_RGB_NORM",e[e.S16_RGBA=I(5,4,0)]="S16_RGBA",e[e.S16_RGBA_NORM=I(5,4,1)]="S16_RGBA_NORM",e[e.S32_R=I(6,1,0)]="S32_R",e[e.U16_RGBA_5551=I(97,4,1)]="U16_RGBA_5551",e[e.U16_RGB_565=I(98,3,1)]="U16_RGB_565",e[e.BC1=I(65,4,1)]="BC1",e[e.BC1_SRGB=I(65,4,3)]="BC1_SRGB",e[e.BC2=I(66,4,1)]="BC2",e[e.BC2_SRGB=I(66,4,3)]="BC2_SRGB",e[e.BC3=I(67,4,1)]="BC3",e[e.BC3_SRGB=I(67,4,3)]="BC3_SRGB",e[e.BC4_UNORM=I(68,1,1)]="BC4_UNORM",e[e.BC4_SNORM=I(69,1,1)]="BC4_SNORM",e[e.BC5_UNORM=I(70,2,1)]="BC5_UNORM",e[e.BC5_SNORM=I(71,2,1)]="BC5_SNORM",e[e.D24=I(129,1,4)]="D24",e[e.D24_S8=I(131,2,12)]="D24_S8",e[e.D32F=I(130,1,4)]="D32F",e[e.D32F_S8=I(132,2,12)]="D32F_S8",e[e.U8_RGB_RT=I(1,3,17)]="U8_RGB_RT",e[e.U8_RGBA_RT=I(1,4,17)]="U8_RGBA_RT",e[e.U8_RGBA_RT_SRGB=I(1,4,19)]="U8_RGBA_RT_SRGB",e))(h||{});function Bt(e){return e>>>8&255}function Ae(e){return e>>>16&255}function Xe(e){return e&255}function Gt(e){switch(e){case 8:case 3:case 6:return 4;case 2:case 5:case 7:return 2;case 1:case 4:return 1;default:throw new Error("whoops")}}function er(e){return Gt(Ae(e))}function Tr(e){const t=Gt(Ae(e)),r=Bt(e);return t*r}function tr(e){const t=Xe(e);if(t&4)return k.Depth;if(t&1)return k.Float;const r=Ae(e);if(r===7||r===8)return k.Float;if(r===1||r===2||r===3)return k.Uint;if(r===4||r===5||r===6)return k.Sint;throw new Error("whoops")}function b(e,t=""){if(!e)throw new Error(`Assert fail: ${t}`)}function be(e){if(e!=null)return e;throw new Error("Missing object")}function pr(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function rr(e,t){e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a}function ir(e){const{r:t,g:r,b:i,a:n}=e;return{r:t,g:r,b:i,a:n}}function nr(e,t,r,i=1){return{r:e,g:t,b:r,a:i}}const de=nr(0,0,0,0),ie=nr(1,1,1,0);function ot(e){return!!(e&&!(e&e-1))}function De(e,t){return e??t}function gr(e){return e===void 0?null:e}function at(e,t){const r=t-1;return e+r&~r}function Sr(e,t){const r=new Array(e);for(let i=0;i<e;i++)r[i]=t();return r}function mr(e,t=1){return e.split(`
`).map((i,n)=>`${Cr(""+(t+n),4," ")}  ${i}`).join(`
`)}function Cr(e,t,r="0"){for(;e.length<t;)e=`${r}${e}`;return e}function Pt(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function lt(e,t){return e===void 0&&(e={}),e.compare=t.compare,e.depthFailOp=t.depthFailOp,e.passOp=t.passOp,e.failOp=t.failOp,e}function Nr(e,t){return e===void 0&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),Pt(e.rgbBlendState,t.rgbBlendState),Pt(e.alphaBlendState,t.alphaBlendState),e.channelWriteMask=t.channelWriteMask,e}function sr(e,t){e.length!==t.length&&(e.length=t.length);for(let r=0;r<t.length;r++)e[r]=Nr(e[r],t[r])}function Br(e,t){t.attachmentsState!==void 0&&sr(e.attachmentsState,t.attachmentsState),e.blendConstant&&t.blendConstant&&rr(e.blendConstant,t.blendConstant),e.depthCompare=De(t.depthCompare,e.depthCompare),e.depthWrite=De(t.depthWrite,e.depthWrite),e.stencilWrite=De(t.stencilWrite,e.stencilWrite),e.stencilFront&&t.stencilFront&&lt(e.stencilFront,t.stencilFront),e.stencilBack&&t.stencilBack&&lt(e.stencilBack,t.stencilBack),e.cullMode=De(t.cullMode,e.cullMode),e.frontFace=De(t.frontFace,e.frontFace),e.polygonOffset=De(t.polygonOffset,e.polygonOffset)}function je(e){const t=Object.assign({},e);return t.attachmentsState=[],sr(t.attachmentsState,e.attachmentsState),t.blendConstant=t.blendConstant&&ir(t.blendConstant),t.stencilFront=lt(void 0,e.stencilFront),t.stencilBack=lt(void 0,e.stencilBack),t}const Dt={blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ZERO},Ve={attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:Dt,alphaBlendState:Dt}],blendConstant:ir(de),depthWrite:!0,depthCompare:w.LEQUAL,stencilWrite:!1,stencilFront:{compare:w.ALWAYS,passOp:Q.KEEP,depthFailOp:Q.KEEP,failOp:Q.KEEP},stencilBack:{compare:w.ALWAYS,passOp:Q.KEEP,depthFailOp:Q.KEEP,failOp:Q.KEEP},cullMode:Z.NONE,frontFace:st.CCW,polygonOffset:!1};function Ir(e=null,t=Ve){const r=je(t);return e!==null&&Br(r,e),r}Ir({depthCompare:w.ALWAYS,depthWrite:!1},Ve);const or={texture:null,sampler:null,formatKind:k.Float,dimension:P.TEXTURE_2D};var Mr=1e-6,qe=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function v(){var e=new qe(16);return qe!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ze(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ue(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],l=t[4],u=t[5],a=t[6],_=t[7],E=t[8],R=t[9],d=t[10],f=t[11],p=t[12],T=t[13],A=t[14],m=t[15],g=r[0],B=r[1],C=r[2],N=r[3];return e[0]=g*i+B*l+C*E+N*p,e[1]=g*n+B*u+C*R+N*T,e[2]=g*s+B*a+C*d+N*A,e[3]=g*o+B*_+C*f+N*m,g=r[4],B=r[5],C=r[6],N=r[7],e[4]=g*i+B*l+C*E+N*p,e[5]=g*n+B*u+C*R+N*T,e[6]=g*s+B*a+C*d+N*A,e[7]=g*o+B*_+C*f+N*m,g=r[8],B=r[9],C=r[10],N=r[11],e[8]=g*i+B*l+C*E+N*p,e[9]=g*n+B*u+C*R+N*T,e[10]=g*s+B*a+C*d+N*A,e[11]=g*o+B*_+C*f+N*m,g=r[12],B=r[13],C=r[14],N=r[15],e[12]=g*i+B*l+C*E+N*p,e[13]=g*n+B*u+C*R+N*T,e[14]=g*s+B*a+C*d+N*A,e[15]=g*o+B*_+C*f+N*m,e}function ht(e,t,r){var i=r[0],n=r[1],s=r[2],o,l,u,a,_,E,R,d,f,p,T,A;return t===e?(e[12]=t[0]*i+t[4]*n+t[8]*s+t[12],e[13]=t[1]*i+t[5]*n+t[9]*s+t[13],e[14]=t[2]*i+t[6]*n+t[10]*s+t[14],e[15]=t[3]*i+t[7]*n+t[11]*s+t[15]):(o=t[0],l=t[1],u=t[2],a=t[3],_=t[4],E=t[5],R=t[6],d=t[7],f=t[8],p=t[9],T=t[10],A=t[11],e[0]=o,e[1]=l,e[2]=u,e[3]=a,e[4]=_,e[5]=E,e[6]=R,e[7]=d,e[8]=f,e[9]=p,e[10]=T,e[11]=A,e[12]=o*i+_*n+f*s+t[12],e[13]=l*i+E*n+p*s+t[13],e[14]=u*i+R*n+T*s+t[14],e[15]=a*i+d*n+A*s+t[15]),e}function Se(e,t,r,i){var n=i[0],s=i[1],o=i[2],l=Math.hypot(n,s,o),u,a,_,E,R,d,f,p,T,A,m,g,B,C,N,V,y,U,L,se,j,oe,z,Ne;return l<Mr?null:(l=1/l,n*=l,s*=l,o*=l,u=Math.sin(r),a=Math.cos(r),_=1-a,E=t[0],R=t[1],d=t[2],f=t[3],p=t[4],T=t[5],A=t[6],m=t[7],g=t[8],B=t[9],C=t[10],N=t[11],V=n*n*_+a,y=s*n*_+o*u,U=o*n*_-s*u,L=n*s*_-o*u,se=s*s*_+a,j=o*s*_+n*u,oe=n*o*_+s*u,z=s*o*_-n*u,Ne=o*o*_+a,e[0]=E*V+p*y+g*U,e[1]=R*V+T*y+B*U,e[2]=d*V+A*y+C*U,e[3]=f*V+m*y+N*U,e[4]=E*L+p*se+g*j,e[5]=R*L+T*se+B*j,e[6]=d*L+A*se+C*j,e[7]=f*L+m*se+N*j,e[8]=E*oe+p*z+g*Ne,e[9]=R*oe+T*z+B*Ne,e[10]=d*oe+A*z+C*Ne,e[11]=f*oe+m*z+N*Ne,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ze(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Or(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function br(e,t,r,i,n){var s=1/Math.tan(t/2),o;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(o=1/(i-n),e[10]=(n+i)*o,e[14]=2*n*i*o):(e[10]=-1,e[14]=-2*i),e}var Fe=br;function Fr(){var e=new qe(3);return qe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function J(e,t,r){var i=new qe(3);return i[0]=e,i[1]=t,i[2]=r,i}(function(){var e=Fr();return function(t,r,i,n,s,o){var l,u;for(r||(r=3),i||(i=0),n?u=Math.min(n*r+i,t.length):u=t.length,l=i;l<u;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],s(e,e,o),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();var Pr=function(e){return e==null};const We=Pr;var Dr={}.toString,Ur=function(e,t){return Dr.call(e)==="[object "+t+"]"};const xr=Ur;var vr=function(e,t,r){return e<t?t:e>r?r:e};const yr=vr;var wr=function(e){return xr(e,"Number")};const ve=wr;function Ut(e,t){return e.compare==t.compare&&e.depthFailOp===t.depthFailOp&&e.failOp===t.failOp&&e.passOp===t.passOp}const Xr=/([^[]*)(\[[0-9]+\])?/;function Vr(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};const t=e.match(Xr);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:Number(t[2])||1,isArray:!!t[2]}}function ee(){let e=null;return(t,r,i)=>{const n=e!==i;return n&&(t.uniform1i(r,i),e=i),n}}function W(e,t,r,i){let n=null,s=null;return(o,l,u)=>{const a=t(u,r),_=a.length;let E=!1;if(n===null)n=new Float32Array(_),s=_,E=!0;else{b(s===_,"Uniform length cannot change.");for(let R=0;R<_;++R)if(a[R]!==n[R]){E=!0;break}}return E&&(i(o,e,l,a),n.set(a)),E}}function G(e,t,r,i){e[t](r,i)}function Te(e,t,r,i){e[t](r,!1,i)}const Wr={},Hr={},kr={},xt=[0];function It(e,t,r,i){t===1&&typeof e=="boolean"&&(e=e?1:0),Number.isFinite(e)&&(xt[0]=e,e=xt);const n=e.length;if(e instanceof r)return e;let s=i[n];s||(s=new r(n),i[n]=s);for(let o=0;o<n;o++)s[o]=e[o];return s}function ce(e,t){return It(e,t,Float32Array,Wr)}function Be(e,t){return It(e,t,Int32Array,Hr)}function Je(e,t){return It(e,t,Uint32Array,kr)}const Lr={[c.FLOAT]:W.bind(null,"uniform1fv",ce,1,G),[c.FLOAT_VEC2]:W.bind(null,"uniform2fv",ce,2,G),[c.FLOAT_VEC3]:W.bind(null,"uniform3fv",ce,3,G),[c.FLOAT_VEC4]:W.bind(null,"uniform4fv",ce,4,G),[c.INT]:W.bind(null,"uniform1iv",Be,1,G),[c.INT_VEC2]:W.bind(null,"uniform2iv",Be,2,G),[c.INT_VEC3]:W.bind(null,"uniform3iv",Be,3,G),[c.INT_VEC4]:W.bind(null,"uniform4iv",Be,4,G),[c.BOOL]:W.bind(null,"uniform1iv",Be,1,G),[c.BOOL_VEC2]:W.bind(null,"uniform2iv",Be,2,G),[c.BOOL_VEC3]:W.bind(null,"uniform3iv",Be,3,G),[c.BOOL_VEC4]:W.bind(null,"uniform4iv",Be,4,G),[c.FLOAT_MAT2]:W.bind(null,"uniformMatrix2fv",ce,4,Te),[c.FLOAT_MAT3]:W.bind(null,"uniformMatrix3fv",ce,9,Te),[c.FLOAT_MAT4]:W.bind(null,"uniformMatrix4fv",ce,16,Te),[c.UNSIGNED_INT]:W.bind(null,"uniform1uiv",Je,1,G),[c.UNSIGNED_INT_VEC2]:W.bind(null,"uniform2uiv",Je,2,G),[c.UNSIGNED_INT_VEC3]:W.bind(null,"uniform3uiv",Je,3,G),[c.UNSIGNED_INT_VEC4]:W.bind(null,"uniform4uiv",Je,4,G),[c.FLOAT_MAT2x3]:W.bind(null,"uniformMatrix2x3fv",ce,6,Te),[c.FLOAT_MAT2x4]:W.bind(null,"uniformMatrix2x4fv",ce,8,Te),[c.FLOAT_MAT3x2]:W.bind(null,"uniformMatrix3x2fv",ce,6,Te),[c.FLOAT_MAT3x4]:W.bind(null,"uniformMatrix3x4fv",ce,12,Te),[c.FLOAT_MAT4x2]:W.bind(null,"uniformMatrix4x2fv",ce,8,Te),[c.FLOAT_MAT4x3]:W.bind(null,"uniformMatrix4x3fv",ce,12,Te),[c.SAMPLER_2D]:ee,[c.SAMPLER_CUBE]:ee,[c.SAMPLER_3D]:ee,[c.SAMPLER_2D_SHADOW]:ee,[c.SAMPLER_2D_ARRAY]:ee,[c.SAMPLER_2D_ARRAY_SHADOW]:ee,[c.SAMPLER_CUBE_SHADOW]:ee,[c.INT_SAMPLER_2D]:ee,[c.INT_SAMPLER_3D]:ee,[c.INT_SAMPLER_CUBE]:ee,[c.INT_SAMPLER_2D_ARRAY]:ee,[c.UNSIGNED_INT_SAMPLER_2D]:ee,[c.UNSIGNED_INT_SAMPLER_3D]:ee,[c.UNSIGNED_INT_SAMPLER_CUBE]:ee,[c.UNSIGNED_INT_SAMPLER_2D_ARRAY]:ee};function vt(e,t,r){const i=Lr[r.type];if(!i)throw new Error(`Unknown GLSL uniform type ${r.type}`);return i().bind(null,e,t)}const Yr={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function Kr(e){return Object.prototype.toString.call(e)in Yr}function He(e,t){return`#define ${e} ${t}`}function zr(e){const t={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,(r,i,n)=>{const s=Number(n);return t[i]=isNaN(s)?n:s,""}),t}function $r(e,t){const r=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,(i,n,s)=>{const o=Number(n);return r.push({location:isNaN(o)?t[n]:o,name:s}),""}),r}function yt(e){if(e===void 0)return null;const t=/binding\s*=\s*(\d+)/.exec(e);if(t!==null){const r=parseInt(t[1],10);if(!Number.isNaN(r))return r}return null}function jr(e){return[e,""]}function ct(e,t,r,i=null){const n=e.glslVersion==="#version 100",s=!1,o=r.split(`
`).map(R=>R.replace(/[/][/].*$/,"")).filter(R=>!(!R||/^\s+$/.test(R)));let l="";i!==null&&(l=Object.keys(i).map(R=>He(R,i[R])).join(`
`));let u=o.find(R=>R.startsWith("precision"))||"precision mediump float;",a=o.filter(R=>!R.startsWith("precision")).join(`
`),_="";if(e.viewportOrigin===_t.UPPER_LEFT&&(_+=`${He("VIEWPORT_ORIGIN_TL","1")}
`),e.clipSpaceNearZ===Et.ZERO&&(_+=`${He("CLIPSPACE_NEAR_ZERO","1")}
`),e.explicitBindingLocations){let R=0,d=0,f=0;a=a.replace(/^(layout\((.*)\))?\s*uniform(.+{)$/gm,(p,T,A,m)=>`layout(${A?`${A}, `:""}set = ${R}, binding = ${d++}) uniform ${m}`),R++,d=0,b(e.separateSamplerTextures),a=a.replace(/^(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,(p,T,A,m,g)=>{let B=yt(A);B===null&&(B=d++);const[C,N]=jr(m);return t==="frag"?`
layout(set = ${R}, binding = ${B*2+0}) uniform texture${C} T_${g};
layout(set = ${R}, binding = ${B*2+1}) uniform sampler${N} S_${g};`.trim():""}),a=a.replace(t==="frag"?/^\b(varying|in)\b/gm:/^\b(varying|out)\b/gm,(p,T)=>`layout(location = ${f++}) ${T}`),_+=`${He("gl_VertexID","gl_VertexIndex")}
`,_+=`${He("gl_InstanceID","gl_InstanceIndex")}
`,u=u.replace(/^precision (.*) sampler(.*);$/gm,"")}else{let R=0;a=a.replace(/^(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,(d,f,p,T,A)=>{let m=yt(p);return m===null&&(m=R++),`uniform sampler${T} ${A}; // BINDING=${m}`})}if(e.separateSamplerTextures)a=a.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,(R,d,f)=>`sampler${d}(T_${f}, S_${f})`),a=a.replace(/\bTEXTURE\((.*?)\)/g,(R,d)=>`T_${d}`);else{const R=[];a=a.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,(d,f,p)=>(R.push([p,f]),p)),n&&R.forEach(([d,f])=>{a=a.replace(new RegExp(`texture\\(${d}`,"g"),()=>`texture${f}(${d}`)}),a=a.replace(/\bTEXTURE\((.*?)\)/g,(d,f)=>f)}let E=`${n?"":e.glslVersion}
${n&&s?`#extension GL_EXT_draw_buffers : require
`:""}
${n&&t==="frag"?`#extension GL_OES_standard_derivatives : enable
`:""}${u}
${_||""}${l?l+`
`:""}
${a}
`.trim();if(e.explicitBindingLocations&&t==="frag"&&(E=E.replace(/^\b(out)\b/g,(R,d)=>`layout(location = 0) ${d}`)),n){if(t==="frag"&&(E=E.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,(R,d,f)=>`varying ${d} ${f};
`)),t==="vert"&&(E=E.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(R,d,f)=>`varying ${d} ${f};
`),E=E.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,(R,d,f)=>`attribute ${d} ${f};
`)),E=E.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,(R,d)=>d.trim().replace(/^.*$/gm,f=>{const p=f.trim();return p.startsWith("#")?p:f?`uniform ${p}`:""})),t==="frag"){let R;E=E.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(f,p,T)=>(R=T,`${p} ${T};
`));const d=E.lastIndexOf("}");E=E.substring(0,d)+`
  gl_FragColor = vec4(${R});
`+E.substring(d)}E=E.replace(/^\s*layout\((.*)\)/gm,"")}return E}function qr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ar={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function n(u,a,_){this.fn=u,this.context=a,this.once=_||!1}function s(u,a,_,E,R){if(typeof _!="function")throw new TypeError("The listener must be a function");var d=new n(_,E||u,R),f=r?r+a:a;return u._events[f]?u._events[f].fn?u._events[f]=[u._events[f],d]:u._events[f].push(d):(u._events[f]=d,u._eventsCount++),u}function o(u,a){--u._eventsCount===0?u._events=new i:delete u._events[a]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var a=[],_,E;if(this._eventsCount===0)return a;for(E in _=this._events)t.call(_,E)&&a.push(r?E.slice(1):E);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(_)):a},l.prototype.listeners=function(a){var _=r?r+a:a,E=this._events[_];if(!E)return[];if(E.fn)return[E.fn];for(var R=0,d=E.length,f=new Array(d);R<d;R++)f[R]=E[R].fn;return f},l.prototype.listenerCount=function(a){var _=r?r+a:a,E=this._events[_];return E?E.fn?1:E.length:0},l.prototype.emit=function(a,_,E,R,d,f){var p=r?r+a:a;if(!this._events[p])return!1;var T=this._events[p],A=arguments.length,m,g;if(T.fn){switch(T.once&&this.removeListener(a,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,_),!0;case 3:return T.fn.call(T.context,_,E),!0;case 4:return T.fn.call(T.context,_,E,R),!0;case 5:return T.fn.call(T.context,_,E,R,d),!0;case 6:return T.fn.call(T.context,_,E,R,d,f),!0}for(g=1,m=new Array(A-1);g<A;g++)m[g-1]=arguments[g];T.fn.apply(T.context,m)}else{var B=T.length,C;for(g=0;g<B;g++)switch(T[g].once&&this.removeListener(a,T[g].fn,void 0,!0),A){case 1:T[g].fn.call(T[g].context);break;case 2:T[g].fn.call(T[g].context,_);break;case 3:T[g].fn.call(T[g].context,_,E);break;case 4:T[g].fn.call(T[g].context,_,E,R);break;default:if(!m)for(C=1,m=new Array(A-1);C<A;C++)m[C-1]=arguments[C];T[g].fn.apply(T[g].context,m)}}return!0},l.prototype.on=function(a,_,E){return s(this,a,_,E,!1)},l.prototype.once=function(a,_,E){return s(this,a,_,E,!0)},l.prototype.removeListener=function(a,_,E,R){var d=r?r+a:a;if(!this._events[d])return this;if(!_)return o(this,d),this;var f=this._events[d];if(f.fn)f.fn===_&&(!R||f.once)&&(!E||f.context===E)&&o(this,d);else{for(var p=0,T=[],A=f.length;p<A;p++)(f[p].fn!==_||R&&!f[p].once||E&&f[p].context!==E)&&T.push(f[p]);T.length?this._events[d]=T.length===1?T[0]:T:o(this,d)}return this},l.prototype.removeAllListeners=function(a){var _;return a?(_=r?r+a:a,this._events[_]&&o(this,_)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(ar);var Qr=ar.exports;const lr=qr(Qr);class _e extends lr{constructor({id:t,device:r}){super(),this.id=t,this.device=r,this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceCreated(this)}destroy(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)}}class Zr extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Bindings;const{uniformBufferBindings:n,samplerBindings:s}=i;this.uniformBufferBindings=n||[],this.samplerBindings=s||[],this.bindingLayouts=this.createBindingLayouts()}createBindingLayouts(){let t=0,r=0;const i=[],n=this.uniformBufferBindings.length,s=this.samplerBindings.length;return i.push({firstUniformBuffer:t,numUniformBuffers:n,firstSampler:r,numSamplers:s}),t+=n,r+=s,{numUniformBuffers:t,numSamplers:r,bindingLayoutTables:i}}}function S(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}function cr(e){switch(Ae(e)){case F.BC1:case F.BC2:case F.BC3:case F.BC4_UNORM:case F.BC4_SNORM:case F.BC5_UNORM:case F.BC5_SNORM:return!0;default:return!1}}function ur(e){if(Xe(e)&ge.Normalized)return!1;const r=Ae(e);return r===F.S8||r===F.S16||r===F.S32||r===F.U8||r===F.U16||r===F.U32}function Jr(e){switch(e){case K.STATIC:return c.STATIC_DRAW;case K.DYNAMIC:return c.DYNAMIC_DRAW}}function wt(e){if(e&M.INDEX)return c.ELEMENT_ARRAY_BUFFER;if(e&M.VERTEX)return c.ARRAY_BUFFER;if(e&M.UNIFORM)return c.UNIFORM_BUFFER}function Gr(e){switch(e){case te.TRIANGLES:return c.TRIANGLES;case te.POINTS:return c.POINTS;case te.TRIANGLE_STRIP:return c.TRIANGLE_STRIP;case te.LINES:return c.LINES;case te.LINE_STRIP:return c.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function ei(e){switch(e){case F.U8:return c.UNSIGNED_BYTE;case F.U16:return c.UNSIGNED_SHORT;case F.U32:return c.UNSIGNED_INT;case F.S8:return c.BYTE;case F.S16:return c.SHORT;case F.S32:return c.INT;case F.F16:return c.HALF_FLOAT;case F.F32:return c.FLOAT;default:throw new Error("whoops")}}function ti(e){switch(e){case he.R:return 1;case he.RG:return 2;case he.RGB:return 3;case he.RGBA:return 4;default:return 1}}function ri(e){const t=Ae(e),r=Bt(e),i=Xe(e),n=ei(t),s=ti(r),o=!!(i&ge.Normalized);return{size:s,type:n,normalized:o}}function ii(e){switch(e){case h.U8_R:return c.UNSIGNED_BYTE;case h.U16_R:return c.UNSIGNED_SHORT;case h.U32_R:return c.UNSIGNED_INT;default:throw new Error("whoops")}}function ke(e){switch(e){case re.CLAMP_TO_EDGE:return c.CLAMP_TO_EDGE;case re.REPEAT:return c.REPEAT;case re.MIRRORED_REPEAT:return c.MIRRORED_REPEAT;default:throw new Error("whoops")}}function Ge(e,t){if(t===q.LINEAR&&e===Y.BILINEAR)return c.LINEAR_MIPMAP_LINEAR;if(t===q.LINEAR&&e===Y.POINT)return c.NEAREST_MIPMAP_LINEAR;if(t===q.NEAREST&&e===Y.BILINEAR)return c.LINEAR_MIPMAP_NEAREST;if(t===q.NEAREST&&e===Y.POINT)return c.NEAREST_MIPMAP_NEAREST;if(t===q.NO_MIP&&e===Y.BILINEAR)return c.LINEAR;if(t===q.NO_MIP&&e===Y.POINT)return c.NEAREST;throw new Error("Unknown texture filter mode")}function we(e,t=0){const r=e;return r.gl_buffer_pages[t/r.pageByteSize|0]}function xe(e){return e.gl_texture}function gt(e){return e.gl_sampler}function Le(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function Xt(e,t){const r=[];for(;;){const i=t.exec(e);if(!i)break;r.push(i)}return r}function Ie(e){return e.blendMode==X.ADD&&e.blendSrcFactor==O.ONE&&e.blendDstFactor===O.ZERO}function ni(e){switch(e){case Nt.OcclusionConservative:return c.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function si(e){if(e===P.TEXTURE_2D)return c.TEXTURE_2D;if(e===P.TEXTURE_2D_ARRAY)return c.TEXTURE_2D_ARRAY;if(e===P.TEXTURE_CUBE_MAP)return c.TEXTURE_CUBE_MAP;if(e===P.TEXTURE_3D)return c.TEXTURE_3D;throw new Error("whoops")}function At(e,t,r,i){return!(e%r!==0||t%i!==0)}class oi extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Buffer;const{viewOrSize:n,usage:s,hint:o=K.STATIC}=i,{uniformBufferMaxPageByteSize:l,gl:u}=r,a=s&M.UNIFORM;a||(S(u)?u.bindVertexArray(null):r.OES_vertex_array_object.bindVertexArrayOES(null));const _=ve(n)?at(n,4):at(n.byteLength,4);this.gl_buffer_pages=[];let E;if(a){let R=_;for(;R>0;)this.gl_buffer_pages.push(this.createBufferPage(Math.min(R,l),s,o)),R-=l;E=l}else this.gl_buffer_pages.push(this.createBufferPage(_,s,o)),E=_;this.pageByteSize=E,this.byteSize=_,this.usage=s,this.gl_target=wt(s),ve(n)||this.setSubData(0,new Uint8Array(n.buffer)),a||(S(u)?u.bindVertexArray(this.device.currentBoundVAO):r.OES_vertex_array_object.bindVertexArrayOES(this.device.currentBoundVAO))}setSubData(t,r,i=0,n=r.byteLength-i){const s=this.device.gl,{pageByteSize:o}=this,l=t+n;let u=t,a=t%o;for(;u<l;){const _=S(s)?s.COPY_WRITE_BUFFER:this.gl_target,E=we(this,u);if(E.ubo)return;s.bindBuffer(_,E),S(s)?s.bufferSubData(_,a,r,i,Math.min(l-u,o)):s.bufferSubData(_,a,r),u+=o,a=0,i+=o,this.device.debugGroupStatisticsBufferUpload()}}destroy(){super.destroy();for(let t=0;t<this.gl_buffer_pages.length;t++)this.gl_buffer_pages[t].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[t]);this.gl_buffer_pages=[]}createBufferPage(t,r,i){const n=this.device.gl,s=r&M.UNIFORM;if(!S(n)&&s)return{ubo:!0};{const o=this.device.ensureResourceExists(n.createBuffer()),l=wt(r),u=Jr(i);return n.bindBuffer(l,o),n.bufferData(l,t,u),o}}}class ai extends _e{constructor({id:t,device:r,descriptor:i}){var E;super({id:t,device:r}),this.type=D.InputLayout;const{vertexBufferDescriptors:n,indexBufferFormat:s,program:o}=i;b(s===h.U16_R||s===h.U32_R||s===null);const l=s!==null?ii(s):null,u=s!==null?er(s):null,a=this.device.gl,_=this.device.ensureResourceExists(S(a)?a.createVertexArray():r.OES_vertex_array_object.createVertexArrayOES());S(a)?a.bindVertexArray(_):r.OES_vertex_array_object.bindVertexArrayOES(_),a.bindBuffer(a.ARRAY_BUFFER,we(this.device.fallbackVertexBuffer));for(const R of i.vertexBufferDescriptors){const{stepMode:d,attributes:f}=R;for(const p of f){const{shaderLocation:T,format:A,divisor:m=1}=p,g=S(a)?T:(E=o.attributes[T])==null?void 0:E.location,B=ri(A);if(p.vertexFormat=B,!We(g)){ur(A);const{size:C,type:N,normalized:V}=B;a.vertexAttribPointer(g,C,N,V,0,0),d===$.INSTANCE&&(S(a)?a.vertexAttribDivisor(g,m):r.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(g,m)),a.enableVertexAttribArray(g)}}}S(a)?a.bindVertexArray(null):r.OES_vertex_array_object.bindVertexArrayOES(null),this.vertexBufferDescriptors=n,this.vao=_,this.indexBufferFormat=s,this.indexBufferType=l,this.indexBufferCompByteSize=u,this.program=o}destroy(){super.destroy(),this.device.currentBoundVAO===this.vao&&(S(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)}}class St extends _e{constructor({id:t,device:r,descriptor:i,fake:n}){super({id:t,device:r}),this.type=D.Texture,i={dimension:P.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1,...i};const s=this.device.gl;let o,l;const u=this.clampmipLevelCount(i);if(this.immutable=i.usage===x.RENDER_TARGET,this.pixelStore=i.pixelStore,this.format=i.format,this.formatKind=tr(i.format),this.width=i.width,this.height=i.height,this.depthOrArrayLayers=i.depthOrArrayLayers,this.mipmaps=u>=1,!n){l=this.device.ensureResourceExists(s.createTexture());const a=this.device.translateTextureType(i.format),_=this.device.translateTextureInternalFormat(i.format);if(this.device.setActiveTexture(s.TEXTURE0),this.device.currentTextures[0]=null,this.preprocessImage(),i.dimension===P.TEXTURE_2D){if(o=c.TEXTURE_2D,s.bindTexture(o,l),this.immutable)if(S(s))s.texStorage2D(o,u,_,i.width,i.height);else{const E=(_===c.DEPTH_COMPONENT||this.isNPOT(),0);(this.format===h.D32F||this.format===h.D24_S8)&&!S(s)&&!r.WEBGL_depth_texture||(s.texImage2D(o,E,_,i.width,i.height,0,_,a,null),this.mipmaps&&this.isNPOT()&&(this.mipmaps=!1,s.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),s.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),s.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE)))}b(i.depthOrArrayLayers===1)}else if(i.dimension===P.TEXTURE_2D_ARRAY)o=c.TEXTURE_2D_ARRAY,s.bindTexture(o,l),this.immutable&&S(s)&&s.texStorage3D(o,u,_,i.width,i.height,i.depthOrArrayLayers);else if(i.dimension===P.TEXTURE_3D)o=c.TEXTURE_3D,s.bindTexture(o,l),this.immutable&&S(s)&&s.texStorage3D(o,u,_,i.width,i.height,i.depthOrArrayLayers);else if(i.dimension===P.TEXTURE_CUBE_MAP)o=c.TEXTURE_CUBE_MAP,s.bindTexture(o,l),this.immutable&&S(s)&&s.texStorage2D(o,u,_,i.width,i.height),b(i.depthOrArrayLayers===6);else throw new Error("whoops")}this.gl_texture=l,this.gl_target=o,this.mipLevelCount=u}setImageData(t,r=0){const i=this.device.gl;cr(this.format);const n=this.gl_target===c.TEXTURE_3D||this.gl_target===c.TEXTURE_2D_ARRAY,s=this.gl_target===c.TEXTURE_CUBE_MAP,o=Kr(t[0]);this.device.setActiveTexture(i.TEXTURE0),this.device.currentTextures[0]=null;const l=t[0];let u,a;o?(u=this.width,a=this.height):(u=l.width,a=l.height,this.width=u,this.height=a),i.bindTexture(this.gl_target,this.gl_texture);const _=this.device.translateTextureFormat(this.format),E=this.device.translateTextureType(this.format);this.preprocessImage();for(let R=0;R<this.depthOrArrayLayers;R++){const d=t[R];let f=this.gl_target;s&&(f=c.TEXTURE_CUBE_MAP_POSITIVE_X+R%6),this.immutable?i.texSubImage2D(f,r,0,0,u,a,_,E,d):S(i)?n?i.texImage3D(f,r,_,u,a,this.depthOrArrayLayers,0,_,E,d):i.texImage2D(f,r,_,u,a,0,_,E,d):o?i.texImage2D(f,r,_,u,a,0,_,E,d):i.texImage2D(f,r,_,_,E,d)}this.mipmaps&&this.generateMipmap(n)}destroy(){super.destroy(),this.device.gl.deleteTexture(xe(this))}clampmipLevelCount(t){if(t.dimension===P.TEXTURE_2D_ARRAY&&t.depthOrArrayLayers>1&&Ae(t.format)===F.BC1){let i=t.width,n=t.height;for(let s=0;s<t.mipLevelCount;s++){if(i<=2||n<=2)return s-1;i=Math.max(i/2|0,1),n=Math.max(n/2|0,1)}}return t.mipLevelCount}preprocessImage(){const t=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&t.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&t.pixelStorei(c.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&t.pixelStorei(c.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))}generateMipmap(t=!1){const r=this.device.gl;return!S(r)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(r.bindTexture(this.gl_target,this.gl_texture),t?(r.texParameteri(this.gl_target,c.TEXTURE_BASE_LEVEL,0),r.texParameteri(this.gl_target,c.TEXTURE_MAX_LEVEL,Math.log2(this.width)),r.texParameteri(this.gl_target,c.TEXTURE_MIN_FILTER,c.LINEAR_MIPMAP_LINEAR),r.texParameteri(this.gl_target,c.TEXTURE_MAG_FILTER,c.LINEAR)):r.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST_MIPMAP_LINEAR),r.generateMipmap(this.gl_target),r.bindTexture(this.gl_target,null)),this)}isNPOT(){const t=this.device.gl;return S(t)?!1:!ot(this.width)||!ot(this.height)}}var Ee=(e=>(e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse",e))(Ee||{});class li extends _e{constructor({id:t,device:r,descriptor:i},n){super({id:t,device:r}),this.rawVertexGLSL=n,this.type=D.Program,this.uniformSetters={},this.attributes=[];const s=this.device.gl;this.descriptor=i,this.gl_program=this.device.ensureResourceExists(s.createProgram()),this.gl_shader_vert=null,this.gl_shader_frag=null,this.compileState=0,this.tryCompileProgram()}destroy(){super.destroy(),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)}tryCompileProgram(){var i,n;b(this.compileState===0);const t=this.descriptor,r=this.device.gl;(i=t.vertex)!=null&&i.glsl&&((n=t.fragment)!=null&&n.glsl)&&(this.gl_shader_vert=this.compileShader(t.vertex.glsl,r.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(t.fragment.glsl,r.FRAGMENT_SHADER),r.attachShader(this.gl_program,this.gl_shader_vert),r.attachShader(this.gl_program,this.gl_shader_frag),r.linkProgram(this.gl_program),this.compileState=1,S(r)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))}readAttributesFromLinkedProgram(){var s;const t=this.device.gl,r=t.getProgramParameter(this.gl_program,t.ACTIVE_ATTRIBUTES),i=zr(this.descriptor.vertex.glsl),n=$r(this.rawVertexGLSL,i);for(let o=0;o<r;o++){const{name:l,type:u,size:a}=t.getActiveAttrib(this.gl_program,o),_=t.getAttribLocation(this.gl_program,l),E=(s=n.find(R=>R.name===l))==null?void 0:s.location;_>=0&&!We(E)&&(this.attributes[E]={name:l,location:_,type:u,size:a})}}readUniformLocationsFromLinkedProgram(){const t=this.device.gl,r=t.getProgramParameter(this.gl_program,t.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const n=t.getActiveUniform(this.gl_program,i),{name:s}=Vr(n.name);let o=t.getUniformLocation(this.gl_program,s);if(this.uniformSetters[s]=vt(t,o,n),n&&n.size>1)for(let l=0;l<n.size;l++)o=t.getUniformLocation(this.gl_program,`${s}[${l}]`),this.uniformSetters[`${s}[${l}]`]=vt(t,o,n)}}compileShader(t,r){const i=this.device.gl,n=this.device.ensureResourceExists(i.createShader(r));return i.shaderSource(n,t),i.compileShader(n),n}setUniformsLegacy(t={}){const r=this.device.gl;if(!S(r)){let i=!1;for(const n in t){i||(r.useProgram(this.gl_program),i=!0);const s=t[n],o=this.uniformSetters[n];if(o){let l=s;l instanceof St&&(l=l.textureIndex),o(l)}}}return this}}class ci extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.QueryPool;const n=this.device.gl;if(S(n)){const{elemCount:s,type:o}=i;this.gl_query=Sr(s,()=>this.device.ensureResourceExists(n.createQuery())),this.gl_query_type=ni(o)}}queryResultOcclusion(t){const r=this.device.gl;if(S(r)){const i=this.gl_query[t];return r.getQueryParameter(i,r.QUERY_RESULT_AVAILABLE)?!!r.getQueryParameter(i,r.QUERY_RESULT):null}return null}destroy(){super.destroy();const t=this.device.gl;if(S(t))for(let r=0;r<this.gl_query.length;r++)t.deleteQuery(this.gl_query[r])}}class ui extends _e{constructor({id:t,device:r}){super({id:t,device:r}),this.type=D.Readback,this.gl_pbo=null,this.gl_sync=null}clientWaitAsync(t,r=0,i=10){const n=this.device.gl;return new Promise((s,o)=>{function l(){const u=n.clientWaitSync(t,r,0);if(u==n.WAIT_FAILED){o();return}if(u==n.TIMEOUT_EXPIRED){setTimeout(l,yr(i,0,n.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}s()}l()})}async getBufferSubDataAsync(t,r,i,n,s=0,o=n.byteLength||0){const l=this.device.gl;if(S(l))return this.gl_sync=l.fenceSync(l.SYNC_GPU_COMMANDS_COMPLETE,0),l.flush(),await this.clientWaitAsync(this.gl_sync,0,10),l.bindBuffer(t,r),l.getBufferSubData(t,i,n,s,o),l.bindBuffer(t,null),n}async readTexture(t,r,i,n,s,o,l=0,u=o.byteLength||0){const a=this.device.gl,_=t,E=this.device.translateTextureFormat(_.format),R=this.device.translateTextureType(_.format),d=Tr(_.format);return S(a)?(this.gl_pbo=this.device.ensureResourceExists(a.createBuffer()),a.bindBuffer(a.PIXEL_PACK_BUFFER,this.gl_pbo),a.bufferData(a.PIXEL_PACK_BUFFER,u,a.STREAM_READ),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),a.bindFramebuffer(c.READ_FRAMEBUFFER,this.device.readbackFramebuffer),a.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,_.gl_texture,0),a.bindBuffer(a.PIXEL_PACK_BUFFER,this.gl_pbo),a.readPixels(r,i,n,s,E,R,l*d),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),this.getBufferSubDataAsync(a.PIXEL_PACK_BUFFER,this.gl_pbo,0,o,l,u)):(a.bindFramebuffer(c.FRAMEBUFFER,this.device.readbackFramebuffer),a.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,_.gl_texture,0),a.pixelStorei(a.PACK_ALIGNMENT,4),a.readPixels(r,i,n,s,a.RGBA,R,o),o)}readTextureSync(t,r,i,n,s,o,l=0,u=o.byteLength||0){const a=this.device.gl,_=t,E=this.device.translateTextureType(_.format);return a.bindFramebuffer(c.FRAMEBUFFER,this.device.readbackFramebuffer),a.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,_.gl_texture,0),a.pixelStorei(a.PACK_ALIGNMENT,4),a.readPixels(r,i,n,s,a.RGBA,E,o),o}async readBuffer(t,r,i,n,s){const o=this.device.gl;return S(o)?this.getBufferSubDataAsync(o.ARRAY_BUFFER,we(t,r),r,i,n,s):Promise.reject()}destroy(){super.destroy(),S(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))}}class _i extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.RenderPipeline,this.drawMode=Gr(i.topology??te.TRIANGLES),this.program=i.program,this.inputLayout=i.inputLayout,this.megaState={...je(Ve),...i.megaStateDescriptor},this.colorAttachmentFormats=i.colorAttachmentFormats.slice(),this.depthStencilAttachmentFormat=i.depthStencilAttachmentFormat,this.sampleCount=i.sampleCount??1}}class Ei extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.RenderTarget,this.gl_renderbuffer=null,this.texture=null;const n=this.device.gl,{format:s,width:o,height:l,sampleCount:u=1,texture:a}=i;let _=!1;if((s===h.D32F||s===h.D24_S8)&&a&&!S(n)&&!r.WEBGL_depth_texture&&(a.destroy(),this.texture=null,_=!0),!_&&a)this.texture=a;else{this.gl_renderbuffer=this.device.ensureResourceExists(n.createRenderbuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.gl_renderbuffer);const E=this.device.translateTextureInternalFormat(s,!0);S(n)?n.renderbufferStorageMultisample(c.RENDERBUFFER,u,E,o,l):n.renderbufferStorage(c.RENDERBUFFER,E,o,l)}this.format=s,this.width=o,this.height=l,this.sampleCount=u}destroy(){super.destroy(),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()}}class hi extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.ComputePipeline,this.descriptor=i}}class Ri{constructor(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}trackResourceCreated(t){this.creationStacks.set(t,new Error().stack),this.liveObjects.add(t)}trackResourceDestroyed(t){this.deletionStacks.has(t)&&console.warn("Object double freed:",t,`

Creation stack: `,this.creationStacks.get(t),`

Deletion stack: `,this.deletionStacks.get(t),`

This stack: `,new Error().stack),this.deletionStacks.set(t,new Error().stack),this.liveObjects.delete(t)}checkForLeaks(){for(const t of this.liveObjects.values())console.warn("Object leaked:",t,"Creation stack:",this.creationStacks.get(t))}setResourceLeakCheck(t,r){r?this.liveObjects.add(t):this.liveObjects.delete(t)}}class di extends _e{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Sampler;const n=this.device.gl;if(S(n)){const s=this.device.ensureResourceExists(n.createSampler());n.samplerParameteri(s,c.TEXTURE_WRAP_S,ke(i.addressModeU)),n.samplerParameteri(s,c.TEXTURE_WRAP_T,ke(i.addressModeV)),n.samplerParameteri(s,c.TEXTURE_WRAP_R,ke(i.addressModeW??i.addressModeU)),n.samplerParameteri(s,c.TEXTURE_MIN_FILTER,Ge(i.minFilter,i.mipmapFilter)),n.samplerParameteri(s,c.TEXTURE_MAG_FILTER,Ge(i.magFilter,q.NO_MIP)),i.lodMinClamp!==void 0&&n.samplerParameterf(s,c.TEXTURE_MIN_LOD,i.lodMinClamp),i.lodMaxClamp!==void 0&&n.samplerParameterf(s,c.TEXTURE_MAX_LOD,i.lodMaxClamp),i.compareFunction!==void 0&&(n.samplerParameteri(s,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.samplerParameteri(s,n.TEXTURE_COMPARE_FUNC,i.compareFunction));const o=i.maxAnisotropy??1;o>1&&this.device.EXT_texture_filter_anisotropic!==null&&(b(i.minFilter===Y.BILINEAR&&i.magFilter===Y.BILINEAR&&i.mipmapFilter===q.LINEAR),n.samplerParameterf(s,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o)),this.gl_sampler=s}else this.descriptor=i}setTextureParameters(t,r,i){const n=this.device.gl,s=this.descriptor;this.isNPOT(r,i)?n.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR):n.texParameteri(t,c.TEXTURE_MIN_FILTER,Ge(s.minFilter,s.mipmapFilter)),n.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,ke(s.addressModeU)),n.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,ke(s.addressModeV)),n.texParameteri(t,c.TEXTURE_MAG_FILTER,Ge(s.magFilter,q.NO_MIP));const o=s.maxAnisotropy??1;o>1&&this.device.EXT_texture_filter_anisotropic!==null&&(b(s.minFilter===Y.BILINEAR&&s.magFilter===Y.BILINEAR&&s.mipmapFilter===q.LINEAR),n.texParameteri(t,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o))}destroy(){super.destroy(),S(this.device.gl)&&this.device.gl.deleteSampler(gt(this))}isNPOT(t,r){return!ot(t)||!ot(r)}}class Ai{dispatchWorkgroups(t,r,i){}dispatchWorkgroupsIndirect(t,r){}setPipeline(t){}setBindings(t){}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}}const Vt=65536;class fi{constructor(t,r){this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_depth_texture=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentDepthStencilResolveTo=null,this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=je(Ve),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=_t.LOWER_LEFT,this.clipSpaceNearZ=Et.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=t,this.contextAttributes=be(t.getContextAttributes()),S(t)?this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"):(this.OES_vertex_array_object=t.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=t.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=t.getExtension("OES_texture_float"),this.WEBGL_depth_texture=t.getExtension("WEBGL_depth_texture"),t.getExtension("EXT_frag_depth"),t.getExtension("OES_element_index_uint"),t.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=t.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=t.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=t.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=t.getExtension("KHR_parallel_shader_compile"),S(t)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new St({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:P.TEXTURE_2D,mipLevelCount:1,usage:x.RENDER_TARGET,format:this.contextAttributes.alpha===!1?h.U8_RGB_RT:h.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=k.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(P.TEXTURE_2D,k.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(P.TEXTURE_2D,k.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:M.VERTEX,hint:K.STATIC}),S(t)&&(this.fallbackTexture2DArray=this.createFallbackTexture(P.TEXTURE_2D_ARRAY,k.Float),this.fallbackTexture3D=this.createFallbackTexture(P.TEXTURE_3D,k.Float),this.fallbackTextureCube=this.createFallbackTexture(P.TEXTURE_CUBE_MAP,k.Float)),this.currentMegaState.depthCompare=w.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=H.ALL,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),this.checkLimits(),r.shaderDebug&&(this.shaderDebug=!0),r.trackResources&&(this.resourceCreationTracker=new Ri)}destroy(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()}createFallbackTexture(t,r){const i=t===P.TEXTURE_CUBE_MAP?6:1,n=r===k.Depth?h.D32F:h.U8_RGBA_NORM,s=this.createTexture({dimension:t,format:n,usage:x.SAMPLED,width:1,height:1,depthOrArrayLayers:i,mipLevelCount:1});return r===k.Float&&s.setImageData([new Uint8Array(4*i)]),xe(s)}getNextUniqueId(){return++this.resourceUniqueId}checkLimits(){const t=this.gl;if(this.maxVertexAttribs=t.getParameter(c.MAX_VERTEX_ATTRIBS),S(t)){this.uniformBufferMaxPageByteSize=Math.min(t.getParameter(c.MAX_UNIFORM_BLOCK_SIZE),Vt),this.uniformBufferWordAlignment=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;const r=t.getInternalformatParameter(t.RENDERBUFFER,t.DEPTH32F_STENCIL8,t.SAMPLES);this.supportedSampleCounts=r?[...r]:[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=Vt;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort((r,i)=>r-i)}configureSwapChain(t,r,i){const n=this.scTexture;n.width=t,n.height=r,this.scPlatformFramebuffer=gr(i)}getDevice(){return this}getCanvas(){return this.gl.canvas}getOnscreenTexture(){return this.scTexture}beginFrame(){}endFrame(){}translateTextureInternalFormat(t,r=!1){switch(t){case h.ALPHA:return c.ALPHA;case h.F16_R:return c.R16F;case h.F16_RG:return c.RG16F;case h.F16_RGB:return c.RGB16F;case h.F16_RGBA:return c.RGBA16F;case h.F32_R:return c.R32F;case h.F32_RG:return c.RG32F;case h.F32_RGB:return c.RGB32F;case h.F32_RGBA:return c.RGBA32F;case h.U8_R_NORM:return c.R8;case h.U8_RG_NORM:return c.RG8;case h.U8_RGB_NORM:case h.U8_RGB_RT:return c.RGB8;case h.U8_RGB_SRGB:return c.SRGB8;case h.U8_RGBA_NORM:case h.U8_RGBA_RT:return S(this.gl)?c.RGBA8:r?c.RGBA4:c.RGBA;case h.U8_RGBA_SRGB:case h.U8_RGBA_RT_SRGB:return c.SRGB8_ALPHA8;case h.U16_R:return c.R16UI;case h.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case h.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case h.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case h.U16_RGBA_5551:return c.RGB5_A1;case h.U16_RGB_565:return c.RGB565;case h.U32_R:return c.R32UI;case h.S8_RGBA_NORM:return c.RGBA8_SNORM;case h.S8_RG_NORM:return c.RG8_SNORM;case h.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case h.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case h.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case h.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case h.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case h.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case h.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case h.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case h.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case h.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case h.D32F_S8:return S(this.gl)?c.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?c.DEPTH_STENCIL:c.DEPTH_COMPONENT16;case h.D24_S8:return S(this.gl)?c.DEPTH24_STENCIL8:this.WEBGL_depth_texture?c.DEPTH_STENCIL:c.DEPTH_COMPONENT16;case h.D32F:return S(this.gl)?c.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?c.DEPTH_COMPONENT:c.DEPTH_COMPONENT16;case h.D24:return S(this.gl)?c.DEPTH_COMPONENT24:this.WEBGL_depth_texture?c.DEPTH_COMPONENT:c.DEPTH_COMPONENT16;default:throw new Error("whoops")}}translateTextureType(t){switch(Ae(t)){case F.U8:return c.UNSIGNED_BYTE;case F.U16:return c.UNSIGNED_SHORT;case F.U32:return c.UNSIGNED_INT;case F.S8:return c.BYTE;case F.F16:return c.HALF_FLOAT;case F.F32:return c.FLOAT;case F.U16_PACKED_5551:return c.UNSIGNED_SHORT_5_5_5_1;case F.D32F:return S(this.gl)?c.FLOAT:this.WEBGL_depth_texture?c.UNSIGNED_INT:c.UNSIGNED_BYTE;case F.D24:return S(this.gl)?c.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?c.UNSIGNED_SHORT:c.UNSIGNED_BYTE;case F.D24S8:return S(this.gl)?c.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?c.UNSIGNED_INT_24_8_WEBGL:c.UNSIGNED_BYTE;case F.D32FS8:return c.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}}translateTextureFormat(t){if(cr(t))return this.translateTextureInternalFormat(t);const r=S(this.gl)||!S(this.gl)&&!!this.WEBGL_depth_texture;switch(t){case h.D24_S8:case h.D32F_S8:return r?c.DEPTH_STENCIL:c.RGBA;case h.D24:case h.D32F:return r?c.DEPTH_COMPONENT:c.RGBA}const i=ur(t);switch(Bt(t)){case he.A:return c.ALPHA;case he.R:return i?c.RED_INTEGER:c.RED;case he.RG:return i?c.RG_INTEGER:c.RG;case he.RGB:return i?c.RGB_INTEGER:c.RGB;case he.RGBA:return c.RGBA}}setActiveTexture(t){this.currentActiveTexture!==t&&(this.gl.activeTexture(t),this.currentActiveTexture=t)}bindVAO(t){this.currentBoundVAO!==t&&(S(this.gl)?this.gl.bindVertexArray(t):this.OES_vertex_array_object.bindVertexArrayOES(t),this.currentBoundVAO=t)}programCompiled(t){b(t.compileState!==Ee.NeedsCompile),t.compileState===Ee.Compiling&&(t.compileState=Ee.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(t))}useProgram(t){this.currentProgram!==t&&(this.programCompiled(t),this.gl.useProgram(t.gl_program),this.currentProgram=t)}ensureResourceExists(t){if(t===null){const r=this.gl.getError();throw new Error(`Created resource is null; GL error encountered: ${r}`)}else return t}createBuffer(t){return new oi({id:this.getNextUniqueId(),device:this,descriptor:t})}createTexture(t){return new St({id:this.getNextUniqueId(),device:this,descriptor:t})}createSampler(t){return new di({id:this.getNextUniqueId(),device:this,descriptor:t})}createRenderTarget(t){return new Ei({id:this.getNextUniqueId(),device:this,descriptor:t})}createRenderTargetFromTexture(t){const{format:r,width:i,height:n,mipLevelCount:s}=t;return b(s===1),this.createRenderTarget({format:r,width:i,height:n,sampleCount:1,texture:t})}createProgram(t){var i,n,s;const r=(i=t.vertex)==null?void 0:i.glsl;return(n=t.vertex)!=null&&n.glsl&&(t.vertex.glsl=ct(this.queryVendorInfo(),"vert",t.vertex.glsl)),(s=t.fragment)!=null&&s.glsl&&(t.fragment.glsl=ct(this.queryVendorInfo(),"frag",t.fragment.glsl)),this.createProgramSimple(t,r)}createProgramSimple(t,r){return new li({id:this.getNextUniqueId(),device:this,descriptor:t},r)}createBindings(t){return new Zr({id:this.getNextUniqueId(),device:this,descriptor:t})}createInputLayout(t){return new ai({id:this.getNextUniqueId(),device:this,descriptor:t})}createRenderPipeline(t){return new _i({id:this.getNextUniqueId(),device:this,descriptor:t})}createComputePass(){return new Ai}createComputePipeline(t){return new hi({id:this.getNextUniqueId(),device:this,descriptor:t})}createReadback(){return new ui({id:this.getNextUniqueId(),device:this})}createQueryPool(t,r){return new ci({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})}formatRenderPassDescriptor(t){const{colorAttachment:r}=t;t.depthClearValue=t.depthClearValue??"load",t.stencilClearValue=t.stencilClearValue??"load";for(let i=0;i<r.length;i++)t.colorAttachmentLevel||(t.colorAttachmentLevel=[]),t.colorAttachmentLevel[i]=t.colorAttachmentLevel[i]??0,t.colorResolveToLevel||(t.colorResolveToLevel=[]),t.colorResolveToLevel[i]=t.colorResolveToLevel[i]??0,t.colorClearColor||(t.colorClearColor=[]),t.colorClearColor[i]=t.colorClearColor[i]??"load",t.colorStore||(t.colorStore=[]),t.colorStore[i]=t.colorStore[i]??!1}createRenderPass(t){b(this.currentRenderPassDescriptor===null),this.currentRenderPassDescriptor=t,this.formatRenderPassDescriptor(t);const{colorAttachment:r,colorAttachmentLevel:i,colorClearColor:n,colorResolveTo:s,colorResolveToLevel:o,depthStencilAttachment:l,depthClearValue:u,stencilClearValue:a,depthStencilResolveTo:_}=t;this.setRenderPassParametersBegin(r.length);for(let E=0;E<r.length;E++)this.setRenderPassParametersColor(E,r[E],i[E],s[E],o[E]);this.setRenderPassParametersDepthStencil(l,_),this.validateCurrentAttachments();for(let E=0;E<r.length;E++){const R=n[E];R!=="load"&&this.setRenderPassParametersClearColor(E,R.r,R.g,R.b,R.a)}return this.setRenderPassParametersClearDepthStencil(u,a),this}submitPass(t){b(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptor=null}copySubTexture2D(t,r,i,n,s,o){const l=this.gl,u=t,a=n;b(a.mipLevelCount===1),b(u.mipLevelCount===1),S(l)&&(u===this.scTexture?l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,u,0)),l.bindFramebuffer(l.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,a,0),l.blitFramebuffer(s,o,s+a.width,o+a.height,r,i,r+a.width,i+a.height,l.COLOR_BUFFER_BIT,l.LINEAR),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null))}queryLimits(){return this}queryTextureFormatSupported(t,r,i){switch(t){case h.BC1_SRGB:case h.BC2_SRGB:case h.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?At(r,i,4,4):!1;case h.BC1:case h.BC2:case h.BC3:return this.WEBGL_compressed_texture_s3tc!==null?At(r,i,4,4):!1;case h.BC4_UNORM:case h.BC4_SNORM:case h.BC5_UNORM:case h.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?At(r,i,4,4):!1;case h.U16_R_NORM:case h.U16_RG_NORM:case h.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case h.F32_R:case h.F32_RG:case h.F32_RGB:case h.F32_RGBA:return this.OES_texture_float_linear!==null;case h.F16_R:case h.F16_RG:case h.F16_RGB:case h.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}}queryProgramReady(t){const r=this.gl;if(t.compileState===Ee.NeedsCompile)throw new Error("whoops");if(t.compileState===Ee.Compiling){let i;return this.KHR_parallel_shader_compile!==null?i=r.getProgramParameter(t.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):i=!0,i&&this.programCompiled(t),i}return t.compileState===Ee.NeedsBind||t.compileState===Ee.ReadyToUse}queryPlatformAvailable(){return this.gl.isContextLost()}queryVendorInfo(){return this}queryRenderPass(t){return this.currentRenderPassDescriptor}queryRenderTarget(t){return t}setResourceName(t,r){if(t.name=r,t.type===D.Buffer){const{gl_buffer_pages:i}=t;for(let n=0;n<i.length;n++)Le(i[n],`${r} Page ${n}`)}else if(t.type===D.Texture)Le(xe(t),r);else if(t.type===D.Sampler)Le(gt(t),r);else if(t.type===D.RenderTarget){const{gl_renderbuffer:i}=t;i!==null&&Le(i,r)}else t.type===D.InputLayout&&Le(t.vao,r)}setResourceLeakCheck(t,r){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(t,r)}checkForLeaks(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}programPatched(t,r){b(this.shaderDebug)}getBufferData(t,r,i=0){const n=this.gl;S(n)&&(n.bindBuffer(n.COPY_READ_BUFFER,we(t,i*4)),n.getBufferSubData(n.COPY_READ_BUFFER,i*4,r))}debugGroupStatisticsDrawCall(t=1){for(let r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].drawCallCount+=t}debugGroupStatisticsBufferUpload(t=1){for(let r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].bufferUploadCount+=t}debugGroupStatisticsTextureBind(t=1){for(let r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].textureBindCount+=t}debugGroupStatisticsTriangles(t){for(let r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].triangleCount+=t}reportShaderError(t,r){const i=this.gl,n=i.getShaderParameter(t,i.COMPILE_STATUS);if(!n){console.error(mr(r));const s=i.getExtension("WEBGL_debug_shaders");s&&console.error(s.getTranslatedShaderSource(t)),console.error(i.getShaderInfoLog(t))}return n}checkProgramCompilationForErrors(t){const r=this.gl,i=t.gl_program;if(!r.getProgramParameter(i,r.LINK_STATUS)){const n=t.descriptor;if(!this.reportShaderError(t.gl_shader_vert,n.vertex.glsl)||!this.reportShaderError(t.gl_shader_frag,n.fragment.glsl))return;console.error(r.getProgramInfoLog(t.gl_program))}}bindFramebufferAttachment(t,r,i,n){const s=this.gl;i===null?s.framebufferRenderbuffer(t,r,s.RENDERBUFFER,null):i.type===D.RenderTarget?i.gl_renderbuffer!==null?s.framebufferRenderbuffer(t,r,s.RENDERBUFFER,i.gl_renderbuffer):i.texture!==null&&s.framebufferTexture2D(t,r,c.TEXTURE_2D,xe(i.texture),n):i.type===D.Texture&&s.framebufferTexture2D(t,r,c.TEXTURE_2D,xe(i),n)}bindFramebufferDepthStencilAttachment(t,r){const i=this.gl,n=r!==null?Xe(r.format):ge.Depth|ge.Stencil,s=!!(n&ge.Depth),o=!!(n&ge.Stencil);s&&o?S(this.gl)||!S(this.gl)&&!!this.WEBGL_depth_texture?this.bindFramebufferAttachment(t,i.DEPTH_STENCIL_ATTACHMENT,r,0):this.bindFramebufferAttachment(t,i.DEPTH_ATTACHMENT,r,0):s?(this.bindFramebufferAttachment(t,i.DEPTH_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,i.STENCIL_ATTACHMENT,null,0)):o&&(this.bindFramebufferAttachment(t,i.STENCIL_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,i.DEPTH_ATTACHMENT,null,0))}validateCurrentAttachments(){let t=-1,r=-1,i=-1;for(let n=0;n<this.currentColorAttachments.length;n++){const s=this.currentColorAttachments[n];s!==null&&(t===-1?(t=s.sampleCount,r=s.width,i=s.height):(b(t===s.sampleCount),b(r===s.width),b(i===s.height)))}this.currentDepthStencilAttachment&&(t===-1?t=this.currentDepthStencilAttachment.sampleCount:(b(t===this.currentDepthStencilAttachment.sampleCount),b(r===this.currentDepthStencilAttachment.width),b(i===this.currentDepthStencilAttachment.height))),this.currentSampleCount=t}setRenderPassParametersBegin(t){const r=this.gl;if(S(r)?r.bindFramebuffer(c.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||r.bindFramebuffer(c.FRAMEBUFFER,this.renderPassDrawFramebuffer),!this.inBlitRenderPass)for(let i=t;i<this.currentColorAttachments.length;i++){const n=S(r)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,s=S(r)?c.COLOR_ATTACHMENT0:c.COLOR_ATTACHMENT0_WEBGL;r.framebufferRenderbuffer(n,s+i,c.RENDERBUFFER,null),r.framebufferTexture2D(n,s+i,c.TEXTURE_2D,null,0)}this.currentColorAttachments.length=t}setRenderPassParametersColor(t,r,i,n,s){const o=this.gl;(this.currentColorAttachments[t]!==r||this.currentColorAttachmentLevels[t]!==i)&&(this.currentColorAttachments[t]=r,this.currentColorAttachmentLevels[t]=i,(S(o)||t===0)&&this.bindFramebufferAttachment(S(o)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,(S(o)?c.COLOR_ATTACHMENT0:c.COLOR_ATTACHMENT0_WEBGL)+t,r,i),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[t]!==n||this.currentColorResolveToLevels[t]!==s)&&(this.currentColorResolveTos[t]=n,this.currentColorResolveToLevels[t]=s,n!==null&&(this.resolveColorAttachmentsChanged=!0))}setRenderPassParametersDepthStencil(t,r){const i=this.gl;this.currentDepthStencilAttachment!==t&&(this.currentDepthStencilAttachment=t,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(S(i)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==r&&(this.currentDepthStencilResolveTo=r,r&&(this.resolveDepthStencilAttachmentsChanged=!0))}setRenderPassParametersClearColor(t,r,i,n,s){const o=this.gl;if(this.OES_draw_buffers_indexed!==null){const l=this.currentMegaState.attachmentsState[t];l&&l.channelWriteMask!==H.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(t,!0,!0,!0,!0),l.channelWriteMask=H.ALL)}else{const l=this.currentMegaState.attachmentsState[0];l&&l.channelWriteMask!==H.ALL&&(o.colorMask(!0,!0,!0,!0),l.channelWriteMask=H.ALL)}this.setScissorRectEnabled(!1),S(o)?o.clearBufferfv(o.COLOR,t,[r,i,n,s]):(o.clearColor(r,i,n,s),o.clear(o.COLOR_BUFFER_BIT))}setRenderPassParametersClearDepthStencil(t="load",r="load"){const i=this.gl;t!=="load"&&(b(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(i.depthMask(!0),this.currentMegaState.depthWrite=!0),S(i)?i.clearBufferfv(i.DEPTH,0,[t]):(i.clearDepth(t),i.clear(i.DEPTH_BUFFER_BIT))),r!=="load"&&(b(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(i.enable(i.STENCIL_TEST),i.stencilMask(255),this.currentMegaState.stencilWrite=!0),S(i)?i.clearBufferiv(i.STENCIL,0,[r]):(i.clearStencil(r),i.clear(i.STENCIL_BUFFER_BIT)))}setBindings(t){var l;const r=this.gl,{uniformBufferBindings:i,samplerBindings:n,bindingLayouts:s}=t;b(0<s.bindingLayoutTables.length);const o=s.bindingLayoutTables[0];b(i.length>=o.numUniformBuffers),b(n.length>=o.numSamplers);for(let u=0;u<i.length;u++){const a=i[u];if(a.size===0)continue;const _=o.firstUniformBuffer+u,E=a.buffer,R=a.offset||0,d=a.size||E.byteSize;if(E!==this.currentUniformBuffers[_]||R!==this.currentUniformBufferByteOffsets[_]||d!==this.currentUniformBufferByteSizes[_]){const f=R%E.pageByteSize,p=E.gl_buffer_pages[R/E.pageByteSize|0];b(f+d<=E.pageByteSize),S(r)&&r.bindBufferRange(r.UNIFORM_BUFFER,_,p,f,d),this.currentUniformBuffers[_]=E,this.currentUniformBufferByteOffsets[_]=R,this.currentUniformBufferByteSizes[_]=d}}for(let u=0;u<o.numSamplers;u++){const a=n[u],_=o.firstSampler+u,E=a!==null&&a.sampler!==null?gt(a.sampler):null,R=a!==null&&a.texture!==null?xe(a.texture):null;if(this.currentSamplers[_]!==E&&(S(r)&&r.bindSampler(_,E),this.currentSamplers[_]=E),this.currentTextures[_]!==R){if(this.setActiveTexture(r.TEXTURE0+_),R!==null){const{gl_target:d,width:f,height:p}=be(a).texture;a.texture.textureIndex=_,r.bindTexture(d,R),S(r)||(l=a.sampler)==null||l.setTextureParameters(d,f,p),this.debugGroupStatisticsTextureBind()}else{const d={...a,...or},{dimension:f,formatKind:p}=d,T=si(f);r.bindTexture(T,this.getFallbackTexture({gl_target:T,formatKind:p,...d}))}this.currentTextures[_]=R}}}setViewport(t,r,i,n){this.gl.viewport(t,r,i,n)}setScissorRect(t,r,i,n){const s=this.gl;this.setScissorRectEnabled(!0),s.scissor(t,r,i,n)}applyAttachmentStateIndexed(t,r,i){const n=this.gl,s=this.OES_draw_buffers_indexed;r.channelWriteMask!==i.channelWriteMask&&(s.colorMaskiOES(t,!!(i.channelWriteMask&H.RED),!!(i.channelWriteMask&H.GREEN),!!(i.channelWriteMask&H.BLUE),!!(i.channelWriteMask&H.ALPHA)),r.channelWriteMask=i.channelWriteMask);const o=r.rgbBlendState.blendMode!==i.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==i.alphaBlendState.blendMode,l=r.rgbBlendState.blendSrcFactor!==i.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==i.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==i.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==i.alphaBlendState.blendDstFactor;(l||o)&&(Ie(r.rgbBlendState)&&Ie(r.alphaBlendState)?s.enableiOES(t,n.BLEND):Ie(i.rgbBlendState)&&Ie(i.alphaBlendState)&&s.disableiOES(t,n.BLEND)),o&&(s.blendEquationSeparateiOES(t,i.rgbBlendState.blendMode,i.alphaBlendState.blendMode),r.rgbBlendState.blendMode=i.rgbBlendState.blendMode,r.alphaBlendState.blendMode=i.alphaBlendState.blendMode),l&&(s.blendFuncSeparateiOES(t,i.rgbBlendState.blendSrcFactor,i.rgbBlendState.blendDstFactor,i.alphaBlendState.blendSrcFactor,i.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=i.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=i.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=i.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=i.alphaBlendState.blendDstFactor)}applyAttachmentState(t,r){const i=this.gl;t.channelWriteMask!==r.channelWriteMask&&(i.colorMask(!!(r.channelWriteMask&H.RED),!!(r.channelWriteMask&H.GREEN),!!(r.channelWriteMask&H.BLUE),!!(r.channelWriteMask&H.ALPHA)),t.channelWriteMask=r.channelWriteMask);const n=t.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,s=t.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(s||n)&&(Ie(t.rgbBlendState)&&Ie(t.alphaBlendState)?i.enable(i.BLEND):Ie(r.rgbBlendState)&&Ie(r.alphaBlendState)&&i.disable(i.BLEND)),n&&(i.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),t.rgbBlendState.blendMode=r.rgbBlendState.blendMode,t.alphaBlendState.blendMode=r.alphaBlendState.blendMode),s&&(i.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)}setMegaState(t){const r=this.gl,i=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(let n=0;n<t.attachmentsState.length;n++)this.applyAttachmentStateIndexed(n,i.attachmentsState[0],t.attachmentsState[0]);else b(t.attachmentsState.length===1),this.applyAttachmentState(i.attachmentsState[0],t.attachmentsState[0]);if(pr(i.blendConstant,t.blendConstant)||(r.blendColor(t.blendConstant.r,t.blendConstant.g,t.blendConstant.b,t.blendConstant.a),rr(i.blendConstant,t.blendConstant)),i.depthCompare!==t.depthCompare&&(r.depthFunc(t.depthCompare),i.depthCompare=t.depthCompare),!!i.depthWrite!=!!t.depthWrite&&(r.depthMask(t.depthWrite),i.depthWrite=t.depthWrite),!!i.stencilWrite!=!!t.stencilWrite&&(r.stencilMask(t.stencilWrite?255:0),i.stencilWrite=t.stencilWrite),!Ut(i.stencilFront,t.stencilFront)){const{passOp:n,failOp:s,depthFailOp:o,compare:l}=t.stencilFront;(i.stencilFront.passOp!==n||i.stencilFront.failOp!==s||i.stencilFront.depthFailOp!==o)&&(r.stencilOpSeparate(r.FRONT,s,o,n),i.stencilFront.passOp=n,i.stencilFront.failOp=s,i.stencilFront.depthFailOp=o),i.stencilFront.compare!==l&&(this.setStencilReference(0),i.stencilFront.compare=l)}if(!Ut(i.stencilBack,t.stencilBack)){const{passOp:n,failOp:s,depthFailOp:o,compare:l}=t.stencilBack;(i.stencilBack.passOp!==n||i.stencilBack.failOp!==s||i.stencilBack.depthFailOp!==o)&&(r.stencilOpSeparate(r.BACK,s,o,n),i.stencilBack.passOp=n,i.stencilBack.failOp=s,i.stencilBack.depthFailOp=o),i.stencilBack.compare!==l&&(this.setStencilReference(0),i.stencilBack.compare=l)}i.cullMode!==t.cullMode&&(i.cullMode===Z.NONE?r.enable(r.CULL_FACE):t.cullMode===Z.NONE&&r.disable(r.CULL_FACE),t.cullMode===Z.BACK?r.cullFace(r.BACK):t.cullMode===Z.FRONT?r.cullFace(r.FRONT):t.cullMode===Z.FRONT_AND_BACK&&r.cullFace(r.FRONT_AND_BACK),i.cullMode=t.cullMode),i.frontFace!==t.frontFace&&(r.frontFace(t.frontFace),i.frontFace=t.frontFace),i.polygonOffset!==t.polygonOffset&&(t.polygonOffset?(r.polygonOffset(1,1),r.enable(r.POLYGON_OFFSET_FILL)):r.disable(r.POLYGON_OFFSET_FILL),i.polygonOffset=t.polygonOffset)}validatePipelineFormats(t){for(let r=0;r<this.currentColorAttachments.length;r++){const i=this.currentColorAttachments[r];i!==null&&b(i.format===t.colorAttachmentFormats[r])}this.currentDepthStencilAttachment&&b(this.currentDepthStencilAttachment.format===t.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&b(this.currentSampleCount===t.sampleCount)}setPipeline(t){this.currentPipeline=t,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);const r=this.currentPipeline.program;if(this.useProgram(r),r.compileState===Ee.NeedsBind){const i=this.gl,n=r.gl_program,s=r.descriptor,o=Xt(s.vertex.glsl,/uniform (\w+) {([^]*?)}/g);if(S(i))for(let u=0;u<o.length;u++){const[,a]=o[u],_=i.getUniformBlockIndex(n,a);_!==-1&&_!==4294967295&&i.uniformBlockBinding(n,_,u)}const l=Xt(s.vertex.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm);for(let u=0;u<l.length;u++){const[,a,_]=l[u],E=i.getUniformLocation(n,a);i.uniform1i(E,parseInt(_))}r.compileState=Ee.ReadyToUse}}setVertexInput(t,r,i){var n;if(t!==null){b(this.currentPipeline.inputLayout===t);const s=t;this.bindVAO(s.vao);const o=this.gl;for(let l=0;l<s.vertexBufferDescriptors.length;l++){const u=s.vertexBufferDescriptors[l],{arrayStride:a,attributes:_}=u;for(const E of _){const{shaderLocation:R,offset:d}=E,f=S(o)?R:(n=s.program.attributes[R])==null?void 0:n.location;if(!We(f)){const p=r[l];if(p===null)continue;const T=E.vertexFormat;o.bindBuffer(o.ARRAY_BUFFER,we(p.buffer));const A=(p.offset||0)+d;o.vertexAttribPointer(f,T.size,T.type,T.normalized,a,A)}}}if(b(i!==null==(s.indexBufferFormat!==null)),i!==null){const l=i.buffer;b(l.usage===M.INDEX),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,we(l)),this.currentIndexBufferByteOffset=i.offset||0}else this.currentIndexBufferByteOffset=null}else b(this.currentPipeline.inputLayout===null),b(i===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0}setStencilReference(t){this.currentStencilRef!==t&&(this.currentStencilRef=t,this.applyStencil())}draw(t,r,i,n){const s=this.gl,o=this.currentPipeline;if(r){const l=[o.drawMode,i||0,t,r];S(s)?s.drawArraysInstanced(...l):this.ANGLE_instanced_arrays.drawArraysInstancedANGLE(...l)}else s.drawArrays(o.drawMode,i,t);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))}drawIndexed(t,r,i,n,s){const o=this.gl,l=this.currentPipeline,u=be(l.inputLayout),a=be(this.currentIndexBufferByteOffset)+i*u.indexBufferCompByteSize;if(r){const _=[l.drawMode,t,u.indexBufferType,a,r];S(o)?o.drawElementsInstanced(..._):this.ANGLE_instanced_arrays.drawElementsInstancedANGLE(..._)}else o.drawElements(l.drawMode,t,u.indexBufferType,a);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))}drawIndirect(t,r){}drawIndexedIndirect(t,r){}beginOcclusionQuery(t){const r=this.gl;if(S(r)){const i=this.currentRenderPassDescriptor.occlusionQueryPool;r.beginQuery(i.gl_query_type,i.gl_query[t])}}endOcclusionQuery(){const t=this.gl;if(S(t)){const r=this.currentRenderPassDescriptor.occlusionQueryPool;t.endQuery(r.gl_query_type)}}pipelineQueryReady(t){const r=t;return this.queryProgramReady(r.program)}pipelineForceReady(t){}endPass(){const t=this.gl;let r=!1;for(let n=0;n<this.currentColorAttachments.length;n++){const s=this.currentColorAttachments[n];if(s!==null){const o=this.currentColorResolveTos[n];let l=!1;o!==null&&(b(s.width===o.width&&s.height===o.height),b(s.format===o.format),this.setScissorRectEnabled(!1),S(t)&&t.bindFramebuffer(t.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&S(t)&&this.bindFramebufferAttachment(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[n]),l=!0,o===this.scTexture?t.bindFramebuffer(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,this.scPlatformFramebuffer):(t.bindFramebuffer(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&t.framebufferTexture2D(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,o.gl_texture,this.currentColorResolveToLevels[n])),S(t)?(t.blitFramebuffer(0,0,s.width,s.height,0,0,o.width,o.height,t.COLOR_BUFFER_BIT,t.LINEAR),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(s,o),r=!0),this.currentRenderPassDescriptor.colorStore[n]||(l||(t.bindFramebuffer(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,t.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[n])),S(t)&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.COLOR_ATTACHMENT0])),t.bindFramebuffer(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;const i=this.currentDepthStencilAttachment;if(i){const n=this.currentDepthStencilResolveTo;let s=!1;n&&(b(i.width===n.width&&i.height===n.height),this.setScissorRectEnabled(!1),t.bindFramebuffer(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),t.bindFramebuffer(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,i),this.bindFramebufferDepthStencilAttachment(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,n)),s=!0,S(t)&&t.blitFramebuffer(0,0,i.width,i.height,0,0,n.width,n.height,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,null),r=!0),this.currentRenderPassDescriptor.depthStencilStore||(s||(t.bindFramebuffer(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,i),s=!0),S(t)&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.DEPTH_STENCIL_ATTACHMENT])),s&&t.bindFramebuffer(S(t)?c.READ_FRAMEBUFFER:c.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}r||t.bindFramebuffer(S(t)?c.DRAW_FRAMEBUFFER:c.FRAMEBUFFER,null)}setScissorRectEnabled(t){if(this.currentScissorEnabled===t)return;const r=this.gl;t?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST),this.currentScissorEnabled=t}applyStencil(){We(this.currentStencilRef)||(this.gl.stencilFuncSeparate(c.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,255),this.gl.stencilFuncSeparate(c.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,255))}getFallbackTexture(t){const r=t.gl_target,i=t.formatKind;if(r===c.TEXTURE_2D)return i===k.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===c.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===c.TEXTURE_3D)return this.fallbackTexture3D;if(r===c.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")}submitBlitRenderPass(t,r){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:M.VERTEX|M.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{format:h.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:te.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:je(Ve)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:t.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:t}));const i=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;const n=this.createRenderPass({colorAttachment:[t],colorResolveTo:[r],colorClearColor:[ie]}),{width:s,height:o}=this.getCanvas();n.setPipeline(this.blitRenderPipeline),n.setBindings(this.blitBindings),n.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),n.setViewport(0,0,s,o),this.gl.disable(this.gl.BLEND),n.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=i,this.inBlitRenderPass=!1}}class Wt{constructor(t){this.pluginOptions=t}async createSwapChain(t){const{targets:r,xrCompatible:i}=this.pluginOptions,n={antialias:!1,preserveDrawingBuffer:!1,stencil:!0,premultipliedAlpha:!0,xrCompatible:i};this.handleContextEvents(t);let s;return r.includes("webgl2")&&(s=t.getContext("webgl2",n)||t.getContext("experimental-webgl2",n)),!s&&r.includes("webgl1")&&(s=t.getContext("webgl",n)||t.getContext("experimental-webgl",n)),new fi(s,{shaderDebug:!0,trackResources:!0})}handleContextEvents(t){const{onContextLost:r,onContextRestored:i,onContextCreationError:n}=this.pluginOptions;n&&t.addEventListener("webglcontextcreationerror",n,!1),r&&t.addEventListener("webglcontextlost",r,!1),i&&t.addEventListener("webglcontextrestored",i,!1)}}let ae;const _r=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&_r.decode();let Ye=null;function tt(){return(Ye===null||Ye.byteLength===0)&&(Ye=new Uint8Array(ae.memory.buffer)),Ye}function mt(e,t){return e=e>>>0,_r.decode(tt().subarray(e,e+t))}const pe=new Array(128).fill(void 0);pe.push(void 0,null,!0,!1);let $e=pe.length;function Ti(e){$e===pe.length&&pe.push(pe.length+1);const t=$e;return $e=pe[t],pe[t]=e,t}function rt(e){return pe[e]}function pi(e){e<132||(pe[e]=$e,$e=e)}function gi(e){const t=rt(e);return pi(e),t}let ut=0;const it=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Si=typeof it.encodeInto=="function"?function(e,t){return it.encodeInto(e,t)}:function(e,t){const r=it.encode(e);return t.set(r),{read:e.length,written:r.length}};function Ht(e,t,r){if(r===void 0){const l=it.encode(e),u=t(l.length,1)>>>0;return tt().subarray(u,u+l.length).set(l),ut=l.length,u}let i=e.length,n=t(i,1)>>>0;const s=tt();let o=0;for(;o<i;o++){const l=e.charCodeAt(o);if(l>127)break;s[n+o]=l}if(o!==i){o!==0&&(e=e.slice(o)),n=r(n,i,i=o+e.length*3,1)>>>0;const l=tt().subarray(n+o,n+i),u=Si(e,l);o+=u.written}return ut=o,n}let Ke=null;function kt(){return(Ke===null||Ke.byteLength===0)&&(Ke=new Int32Array(ae.memory.buffer)),Ke}function mi(e,t,r){let i,n;try{const l=ae.__wbindgen_add_to_stack_pointer(-16),u=Ht(e,ae.__wbindgen_malloc,ae.__wbindgen_realloc),a=ut,_=Ht(t,ae.__wbindgen_malloc,ae.__wbindgen_realloc),E=ut;ae.glsl_compile(l,u,a,_,E,r);var s=kt()[l/4+0],o=kt()[l/4+1];return i=s,n=o,mt(s,o)}finally{ae.__wbindgen_add_to_stack_pointer(16),ae.__wbindgen_free(i,n,1)}}async function Ci(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(i){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function Ni(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(t,r){const i=mt(t,r);return Ti(i)},e.wbg.__wbindgen_object_drop_ref=function(t){gi(t)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(t){console.log(rt(t))},e.wbg.__wbg_log_576ca876af0d4a77=function(t,r){console.log(rt(t),rt(r))},e.wbg.__wbindgen_throw=function(t,r){throw new Error(mt(t,r))},e}function Bi(e,t){return ae=e.exports,Er.__wbindgen_wasm_module=t,Ke=null,Ye=null,ae}async function Er(e){if(ae!==void 0)return ae;const t=Ni();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:i}=await Ci(await e,t);return Bi(r,i)}var le=(e=>(e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT",e))(le||{}),hr=(e=>(e[e.READ=1]="READ",e[e.WRITE=2]="WRITE",e))(hr||{});function Ii(e){let t=0;return e&x.SAMPLED&&(t|=le.TEXTURE_BINDING|le.COPY_DST),e&x.RENDER_TARGET&&(t|=le.RENDER_ATTACHMENT|le.TEXTURE_BINDING|le.COPY_SRC|le.COPY_DST),t}function Mt(e){if(e===h.U8_R_NORM)return"r8unorm";if(e===h.U8_RG_NORM)return"rg8unorm";if(e===h.U8_RGBA_RT)return"bgra8unorm";if(e===h.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(e===h.U8_RGBA_NORM)return"rgba8unorm";if(e===h.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(e===h.S8_R_NORM)return"r8snorm";if(e===h.S8_RG_NORM)return"rg8snorm";if(e===h.S8_RGBA_NORM)return"rgba8snorm";if(e===h.U32_R)return"r32uint";if(e===h.F16_RGBA)return"rgba16float";if(e===h.F32_RGBA)return"rgba32float";if(e===h.D24)return"depth24plus";if(e===h.D24_S8)return"depth24plus-stencil8";if(e===h.D32F)return"depth32float";if(e===h.D32F_S8)return"depth32float-stencil8";if(e===h.BC1)return"bc1-rgba-unorm";if(e===h.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(e===h.BC2)return"bc2-rgba-unorm";if(e===h.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(e===h.BC3)return"bc3-rgba-unorm";if(e===h.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(e===h.BC4_SNORM)return"bc4-r-snorm";if(e===h.BC4_UNORM)return"bc4-r-unorm";if(e===h.BC5_SNORM)return"bc5-rg-snorm";if(e===h.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function Mi(e){if(e===P.TEXTURE_2D)return"2d";if(e===P.TEXTURE_CUBE_MAP)return"2d";if(e===P.TEXTURE_2D_ARRAY)return"2d";if(e===P.TEXTURE_3D)return"3d";throw new Error("whoops")}function Oi(e){if(e===P.TEXTURE_2D)return"2d";if(e===P.TEXTURE_CUBE_MAP)return"cube";if(e===P.TEXTURE_2D_ARRAY)return"2d-array";if(e===P.TEXTURE_3D)return"3d";throw new Error("whoops")}function bi(e){let t=0;return e&M.INDEX&&(t|=GPUBufferUsage.INDEX),e&M.VERTEX&&(t|=GPUBufferUsage.VERTEX),e&M.UNIFORM&&(t|=GPUBufferUsage.UNIFORM),e&M.STORAGE&&(t|=GPUBufferUsage.STORAGE),e&M.COPY_SRC&&(t|=GPUBufferUsage.COPY_SRC),t|=GPUBufferUsage.COPY_DST,t}function ft(e){if(e===re.CLAMP_TO_EDGE)return"clamp-to-edge";if(e===re.REPEAT)return"repeat";if(e===re.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function Lt(e){if(e===Y.BILINEAR)return"linear";if(e===Y.POINT)return"nearest";throw new Error("whoops")}function Fi(e){if(e===q.LINEAR)return"linear";if(e===q.NEAREST)return"nearest";if(e===q.NO_MIP)return"nearest";throw new Error("whoops")}function ye(e){return e.gpuBuffer}function Pi(e){return e.gpuSampler}function Di(e){return e.querySet}function Ui(e){if(e===Nt.OcclusionConservative)return"occlusion";throw new Error("whoops")}function xi(e){switch(e){case te.TRIANGLES:return"triangle-list";case te.POINTS:return"point-list";case te.TRIANGLE_STRIP:return"triangle-strip";case te.LINES:return"line-list";case te.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function vi(e){if(e===Z.NONE)return"none";if(e===Z.FRONT)return"front";if(e===Z.BACK)return"back";throw new Error("whoops")}function yi(e){if(e===st.CCW)return"ccw";if(e===st.CW)return"cw";throw new Error("whoops")}function wi(e,t){return{topology:xi(e),cullMode:vi(t.cullMode),frontFace:yi(t.frontFace)}}function Yt(e){if(e===O.ZERO)return"zero";if(e===O.ONE)return"one";if(e===O.SRC)return"src";if(e===O.ONE_MINUS_SRC)return"one-minus-src";if(e===O.DST)return"dst";if(e===O.ONE_MINUS_DST)return"one-minus-dst";if(e===O.SRC_ALPHA)return"src-alpha";if(e===O.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===O.DST_ALPHA)return"dst-alpha";if(e===O.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(e===O.CONST)return"constant";if(e===O.ONE_MINUS_CONSTANT)return"one-minus-constant";if(e===O.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function Xi(e){if(e===X.ADD)return"add";if(e===X.SUBSTRACT)return"subtract";if(e===X.REVERSE_SUBSTRACT)return"reverse-subtract";if(e===X.MIN)return"min";if(e===X.MAX)return"max";throw new Error("whoops")}function Kt(e){return{operation:Xi(e.blendMode),srcFactor:Yt(e.blendSrcFactor),dstFactor:Yt(e.blendDstFactor)}}function zt(e){return e.blendMode===X.ADD&&e.blendSrcFactor===O.ONE&&e.blendDstFactor===O.ZERO}function Vi(e){if(!(zt(e.rgbBlendState)&&zt(e.alphaBlendState)))return{color:Kt(e.rgbBlendState),alpha:Kt(e.alphaBlendState)}}function Wi(e,t){return{format:Mt(t),blend:Vi(e),writeMask:e.channelWriteMask}}function Hi(e,t){return t.attachmentsState.map((r,i)=>Wi(r,e[i]))}function nt(e){if(e===w.NEVER)return"never";if(e===w.LESS)return"less";if(e===w.EQUAL)return"equal";if(e===w.LEQUAL)return"less-equal";if(e===w.GREATER)return"greater";if(e===w.NOTEQUAL)return"not-equal";if(e===w.GEQUAL)return"greater-equal";if(e===w.ALWAYS)return"always";throw new Error("whoops")}function Ue(e){if(e===Q.KEEP)return"keep";if(e===Q.REPLACE)return"replace";if(e===Q.ZERO)return"zero";if(e===Q.DECREMENT_CLAMP)return"decrement-clamp";if(e===Q.DECREMENT_WRAP)return"decrement-wrap";if(e===Q.INCREMENT_CLAMP)return"increment-clamp";if(e===Q.INCREMENT_WRAP)return"increment-wrap";if(e===Q.INVERT)return"invert";throw new Error("whoops")}function ki(e,t){if(!We(e))return{format:Mt(e),depthWriteEnabled:!!t.depthWrite,depthCompare:nt(t.depthCompare),depthBias:t.polygonOffset?1:0,depthBiasSlopeScale:t.polygonOffset?1:0,stencilFront:{compare:nt(t.stencilFront.compare),passOp:Ue(t.stencilFront.passOp),failOp:Ue(t.stencilFront.failOp),depthFailOp:Ue(t.stencilFront.depthFailOp)},stencilBack:{compare:nt(t.stencilBack.compare),passOp:Ue(t.stencilBack.passOp),failOp:Ue(t.stencilBack.failOp),depthFailOp:Ue(t.stencilBack.depthFailOp)},stencilReadMask:1,stencilWriteMask:1}}function Li(e){if(e!==null){if(e===h.U16_R)return"uint16";if(e===h.U32_R)return"uint32";throw new Error("whoops")}}function Yi(e){if(e===$.VERTEX)return"vertex";if(e===$.INSTANCE)return"instance";throw new Error("whoops")}function Ki(e){if(e===h.U8_R)return"uint8x2";if(e===h.U8_RG)return"uint8x2";if(e===h.U8_RGB)return"uint8x4";if(e===h.U8_RGBA)return"uint8x4";if(e===h.U8_RG_NORM)return"unorm8x2";if(e===h.U8_RGBA_NORM)return"unorm8x4";if(e===h.S8_RGB_NORM)return"snorm8x4";if(e===h.S8_RGBA_NORM)return"snorm8x4";if(e===h.U16_RG_NORM)return"unorm16x2";if(e===h.U16_RGBA_NORM)return"unorm16x4";if(e===h.S16_RG_NORM)return"snorm16x2";if(e===h.S16_RGBA_NORM)return"snorm16x4";if(e===h.S16_RG)return"uint16x2";if(e===h.F16_RG)return"float16x2";if(e===h.F16_RGBA)return"float16x4";if(e===h.F32_R)return"float32";if(e===h.F32_RG)return"float32x2";if(e===h.F32_RGB)return"float32x3";if(e===h.F32_RGBA)return"float32x4";throw"whoops"}function zi(e){switch(Ae(e)){case F.BC1:case F.BC2:case F.BC3:case F.BC4_SNORM:case F.BC4_UNORM:case F.BC5_SNORM:case F.BC5_UNORM:return!0;default:return!1}}function $i(e){switch(Ae(e)){case F.BC1:case F.BC2:case F.BC3:case F.BC4_SNORM:case F.BC4_UNORM:case F.BC5_SNORM:case F.BC5_UNORM:return 4;default:return 1}}function $t(e,t,r=!1,i){switch(e){case h.S8_R:case h.S8_R_NORM:case h.S8_RG_NORM:case h.S8_RGB_NORM:case h.S8_RGBA_NORM:{const s=t instanceof ArrayBuffer?new Int8Array(t):new Int8Array(t);return i&&s.set(new Int8Array(i)),s}case h.U8_R:case h.U8_R_NORM:case h.U8_RG:case h.U8_RG_NORM:case h.U8_RGB:case h.U8_RGB_NORM:case h.U8_RGB_SRGB:case h.U8_RGBA:case h.U8_RGBA_NORM:case h.U8_RGBA_SRGB:{const s=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return i&&s.set(new Uint8Array(i)),s}case h.S16_R:case h.S16_RG:case h.S16_RG_NORM:case h.S16_RGB_NORM:case h.S16_RGBA:case h.S16_RGBA_NORM:{const s=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return i&&s.set(new Int16Array(i)),s}case h.U16_R:case h.U16_RGB:case h.U16_RGBA_5551:case h.U16_RGBA_NORM:case h.U16_RG_NORM:case h.U16_R_NORM:{const s=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return i&&s.set(new Uint16Array(i)),s}case h.S32_R:{const s=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return i&&s.set(new Int32Array(i)),s}case h.U32_R:case h.U32_RG:{const s=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return i&&s.set(new Uint32Array(i)),s}case h.F32_R:case h.F32_RG:case h.F32_RGB:case h.F32_RGBA:{const s=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return i&&s.set(new Float32Array(i)),s}}const n=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return i&&n.set(new Uint8Array(i)),n}function ji(e){const t=(e&32768)>>15,r=(e&31744)>>10,i=e&1023;return r===0?(t?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):r==31?i?NaN:(t?-1:1)*(1/0):(t?-1:1)*Math.pow(2,r-15)*(1+i/Math.pow(2,10))}class fe extends lr{constructor({id:t,device:r}){super(),this.id=t,this.device=r}destroy(){}}class qi extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Bindings;const{pipeline:n}=i;b(!!n);const{uniformBufferBindings:s,storageBufferBindings:o,samplerBindings:l}=i;this.numUniformBuffers=(s==null?void 0:s.length)||0;const u=[[],[]];let a=0;if(o&&o.length)for(let _=0;_<o.length;_++){const{binding:E,size:R,offset:d,buffer:f}=i.storageBufferBindings[_],p={buffer:ye(f),offset:d??0,size:R};u[0].push({binding:E??a++,resource:p})}if(s&&s.length)for(let _=0;_<s.length;_++){const{binding:E,size:R,offset:d,buffer:f}=i.uniformBufferBindings[_],p={buffer:ye(f),offset:d??0,size:R};u[0].push({binding:E??a++,resource:p})}if(l&&l.length){a=0;for(let _=0;_<l.length;_++){const E={...l[_],...or},R=i.samplerBindings[_],d=R.texture!==null?R.texture:this.device.getFallbackTexture(E);E.dimension=d.dimension,E.formatKind=tr(d.format);const f=d.gpuTextureView;u[1].push({binding:a++,resource:f});const p=R.sampler!==null?R.sampler:this.device.getFallbackSampler(E),T=Pi(p);u[1].push({binding:a++,resource:T})}}this.gpuBindGroup=u.filter(_=>_.length>0).map((_,E)=>this.device.device.createBindGroup({layout:n.getBindGroupLayout(E),entries:_}))}}class Qi extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Buffer;const{usage:n,viewOrSize:s}=i,o=!!(n&M.MAP_READ);this.usage=bi(n),o&&(this.usage=M.MAP_READ|M.COPY_DST);const l=!ve(s);if(this.view=ve(s)?null:s,this.size=ve(s)?at(s,4):at(s.byteLength,4),ve(s))this.gpuBuffer=this.device.device.createBuffer({usage:this.usage,size:this.size,mappedAtCreation:o?l:!1});else{this.gpuBuffer=this.device.device.createBuffer({usage:this.usage,size:this.size,mappedAtCreation:!0});const u=s&&s.constructor||Float32Array;new u(this.gpuBuffer.getMappedRange()).set(s),this.gpuBuffer.unmap()}}setSubData(t,r,i=0,n=0){const s=this.gpuBuffer;n=n||r.byteLength,n=Math.min(n,this.size-t);let o=r.byteOffset+i,l=o+n;const u=n+3&-4;if(u!==n){const E=new Uint8Array(r.buffer.slice(o,l));r=new Uint8Array(u),r.set(E),i=0,o=0,l=u,n=u}const a=1024*1024*15;let _=0;for(;l-(o+_)>a;)this.device.device.queue.writeBuffer(s,t+_,r.buffer,o+_,a),_+=a;this.device.device.queue.writeBuffer(s,t+_,r.buffer,o+_,n-_)}destroy(){super.destroy(),this.gpuBuffer.destroy()}}class Zi{constructor(){this.commandEncoder=null,this.gpuComputePassEncoder=null}dispatchWorkgroups(t,r,i){this.gpuComputePassEncoder.dispatchWorkgroups(t,r,i)}dispatchWorkgroupsIndirect(t,r){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(t.gpuBuffer,r)}finish(){return this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.commandEncoder.finish()}beginComputePass(){b(this.gpuComputePassEncoder===null),this.gpuComputePassEncoder=this.commandEncoder.beginComputePass(this.gpuComputePassDescriptor)}setPipeline(t){const i=be(t.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(i)}setBindings(t){const r=t;this.gpuComputePassEncoder.setBindGroup(0,r.gpuBindGroup[0])}pushDebugGroup(t){this.gpuComputePassEncoder.pushDebugGroup(t)}popDebugGroup(){this.gpuComputePassEncoder.popDebugGroup()}insertDebugMarker(t){this.gpuComputePassEncoder.insertDebugMarker(t)}}class Ji extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.ComputePipeline,this.gpuComputePipeline=null,this.descriptor=i;const s=i.program.computeStage;if(s===null)return;const o={layout:"auto",compute:{...s}};this.gpuComputePipeline=this.device.device.createComputePipeline(o),this.name!==void 0&&(this.gpuComputePipeline.label=this.name)}getBindGroupLayout(t){return this.gpuComputePipeline.getBindGroupLayout(t)}}class Gi extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.InputLayout;const n=[];for(const s of i.vertexBufferDescriptors){const{arrayStride:o,stepMode:l,attributes:u}=s;n.push({arrayStride:o,stepMode:Yi(l),attributes:[]});for(const a of u){const{shaderLocation:_,format:E,offset:R}=a;n[n.length-1].attributes.push({shaderLocation:_,format:Ki(E),offset:R})}}this.indexFormat=Li(i.indexBufferFormat),this.buffers=n}}class en extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Program,this.vertexStage=null,this.fragmentStage=null,this.computeStage=null,this.descriptor=i,i.vertex&&(this.vertexStage=this.createShaderStage(i.vertex,"vertex")),i.fragment&&(this.fragmentStage=this.createShaderStage(i.fragment,"fragment")),i.compute&&(this.computeStage=this.createShaderStage(i.compute,"compute"))}setUniformsLegacy(t={}){}createShaderStage({glsl:t,wgsl:r,entryPoint:i},n){let o=r;if(!o)try{o=this.device.glsl_compile(t,n,!1)}catch(u){throw console.error(u,t),new Error("whoops")}for(const u of["u_TextureFramebufferDepth"])o.includes(u)&&(o=o.replace(`var T_${u}: texture_2d<f32>;`,`var T_${u}: texture_depth_2d;`),o=o.replace(new RegExp(`textureSample\\(T_${u}(.*)\\);$`,"gm"),(a,_)=>`vec4<f32>(textureSample(T_${u}${_}), 0.0, 0.0, 0.0);`));return{module:this.device.device.createShaderModule({code:o}),entryPoint:i||"main"}}}class tn extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.QueryPool;const{elemCount:n,type:s}=i;this.querySet=this.device.device.createQuerySet({type:Ui(s),count:n}),this.resolveBuffer=this.device.device.createBuffer({size:n*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.cpuBuffer=this.device.device.createBuffer({size:n*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),this.results=null}queryResultOcclusion(t){return this.results===null?null:this.results[t]!==BigInt(0)}destroy(){super.destroy(),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()}}class rn extends fe{constructor({id:t,device:r}){super({id:t,device:r}),this.type=D.Readback}async readTexture(t,r,i,n,s,o,l=0,u=0){const a=t,_=0,E=this.getBlockInformationFromFormat(a.gpuTextureformat),R=Math.ceil(n/E.width)*E.length,d=Math.ceil(R/256)*256,f=d*s,p=this.device.createBuffer({usage:M.STORAGE|M.MAP_READ|M.COPY_DST,hint:K.STATIC,viewOrSize:f}),T=this.device.device.createCommandEncoder();return T.copyTextureToBuffer({texture:a.gpuTexture,mipLevel:0,origin:{x:r,y:i,z:Math.max(_,0)}},{buffer:p.gpuBuffer,offset:0,bytesPerRow:d},{width:n,height:s,depthOrArrayLayers:1}),this.device.device.queue.submit([T.finish()]),this.readBuffer(p,0,o.byteLength===f?o:null,l,f,a.format)}readTextureSync(t,r,i,n,s,o,l=0,u=0){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")}readBuffer(t,r=0,i=null,n=0,s=0,o=h.U8_RGB,l=!1,u=!1){const a=t,_=s||a.size,E=i||a.view,R=E&&E.constructor&&E.constructor.BYTES_PER_ELEMENT||er(o);let d=a;if(!(a.usage&M.MAP_READ&&a.usage&M.COPY_DST)){const f=this.device.device.createCommandEncoder();d=this.device.createBuffer({usage:M.STORAGE|M.MAP_READ|M.COPY_DST,hint:K.STATIC,viewOrSize:_}),f.copyBufferToBuffer(a.gpuBuffer,r,d.gpuBuffer,0,_),this.device.device.queue.submit([f.finish()])}return new Promise((f,p)=>{d.gpuBuffer.mapAsync(hr.READ,r,_).then(()=>{const T=d.gpuBuffer.getMappedRange(r,_);let A=E;if(l)A===null?A=$t(o,_,!0,T):A=$t(o,A.buffer,void 0,T);else if(A===null)switch(R){case 1:A=new Uint8Array(_),A.set(new Uint8Array(T));break;case 2:A=this.getHalfFloatAsFloatRGBAArrayBuffer(_/2,T);break;case 4:A=new Float32Array(_/4),A.set(new Float32Array(T));break}else switch(R){case 1:A=new Uint8Array(A.buffer),A.set(new Uint8Array(T));break;case 2:A=this.getHalfFloatAsFloatRGBAArrayBuffer(_/2,T,E);break;case 4:const m=E&&E.constructor||Float32Array;A=new m(A.buffer),A.set(new m(T));break}d.gpuBuffer.unmap(),f(A)},T=>p(T))})}getHalfFloatAsFloatRGBAArrayBuffer(t,r,i){i||(i=new Float32Array(t));const n=new Uint16Array(r);for(;t--;)i[t]=ji(n[t]);return i}getBlockInformationFromFormat(t){switch(t){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}}class nn{constructor(){this.commandEncoder=null,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}getTextureView(t,r){return b(r<t.mipLevelCount),t.mipLevelCount===1?t.gpuTextureView:t.gpuTexture.createView({baseMipLevel:r,mipLevelCount:1})}setRenderPassDescriptor(t){var i,n,s,o,l;this.descriptor=t,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;const r=t.colorAttachment.length;this.gfxColorAttachment.length=r,this.gfxColorResolveTo.length=r;for(let u=0;u<t.colorAttachment.length;u++){let a=t.colorAttachment[u],_=t.colorResolveTo[u];if(a===null&&_!==null&&(a=_,_=null),this.gfxColorAttachment[u]=a,this.gfxColorResolveTo[u]=_,this.gfxColorAttachmentLevel[u]=((i=t.colorAttachmentLevel)==null?void 0:i[u])||0,this.gfxColorResolveToLevel[u]=((n=t.colorResolveToLevel)==null?void 0:n[u])||0,a!==null){this.gpuColorAttachments[u]===void 0&&(this.gpuColorAttachments[u]={});const E=this.gpuColorAttachments[u];E.view=this.getTextureView(a,((s=this.gfxColorAttachmentLevel)==null?void 0:s[u])||0);const R=((o=t.colorClearColor)==null?void 0:o[u])??"load";R==="load"?E.loadOp="load":(E.loadOp="clear",E.clearValue=R),E.storeOp=(l=t.colorStore)!=null&&l[u]?"store":"discard",E.resolveTarget=void 0,_!==null&&(a.sampleCount>1?E.resolveTarget=this.getTextureView(_,this.gfxColorResolveToLevel[u]):E.storeOp="store")}else{this.gpuColorAttachments.length=u,this.gfxColorAttachment.length=u,this.gfxColorResolveTo.length=u;break}}if(this.gfxDepthStencilAttachment=t.depthStencilAttachment,this.gfxDepthStencilResolveTo=t.depthStencilResolveTo,t.depthStencilAttachment){const u=t.depthStencilAttachment,a=this.gpuDepthStencilAttachment;a.view=u.gpuTextureView,!!(Xe(u.format)&ge.Depth)?(t.depthClearValue==="load"?a.depthLoadOp="load":(a.depthLoadOp="clear",a.depthClearValue=t.depthClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?a.depthStoreOp="store":a.depthStoreOp="discard"):(a.depthLoadOp=void 0,a.depthStoreOp=void 0),!!(Xe(u.format)&ge.Stencil)?(t.stencilClearValue==="load"?a.stencilLoadOp="load":(a.stencilLoadOp="clear",a.stencilClearValue=t.stencilClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?a.stencilStoreOp="store":a.stencilStoreOp="discard"):(a.stencilLoadOp=void 0,a.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=We(t.occlusionQueryPool)?void 0:Di(t.occlusionQueryPool)}beginRenderPass(t){b(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(t),this.gpuRenderPassEncoder=this.commandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)}setViewport(t,r,i,n,s=0,o=1){this.gpuRenderPassEncoder.setViewport(t,r,i,n,s,o)}setScissorRect(t,r,i,n){this.gpuRenderPassEncoder.setScissorRect(t,r,i,n)}setPipeline(t){const i=be(t.gpuRenderPipeline);this.gpuRenderPassEncoder.setPipeline(i)}setVertexInput(t,r,i){if(t===null)return;const n=t;i!==null&&this.gpuRenderPassEncoder.setIndexBuffer(ye(i.buffer),be(n.indexFormat),i.offset);for(let s=0;s<r.length;s++){const o=r[s];o!==null&&this.gpuRenderPassEncoder.setVertexBuffer(s,ye(o.buffer),o.offset)}}setBindings(t){const r=t;this.gpuRenderPassEncoder.setBindGroup(0,r.gpuBindGroup[0]),r.gpuBindGroup[1]&&this.gpuRenderPassEncoder.setBindGroup(1,r.gpuBindGroup[1])}setStencilReference(t){this.gpuRenderPassEncoder.setStencilReference(t)}draw(t,r,i,n){this.gpuRenderPassEncoder.draw(t,r,i,n)}drawIndexed(t,r,i,n,s){this.gpuRenderPassEncoder.drawIndexed(t,r,i,n,s)}drawIndirect(t,r){this.gpuRenderPassEncoder.drawIndirect(ye(t),r)}drawIndexedIndirect(t,r){this.gpuRenderPassEncoder.drawIndexedIndirect(ye(t),r)}beginOcclusionQuery(t){this.gpuRenderPassEncoder.beginOcclusionQuery(t)}endOcclusionQuery(){this.gpuRenderPassEncoder.endOcclusionQuery()}pushDebugGroup(t){this.gpuRenderPassEncoder.pushDebugGroup(t)}popDebugGroup(){this.gpuRenderPassEncoder.popDebugGroup()}insertDebugMarker(t){this.gpuRenderPassEncoder.insertDebugMarker(t)}finish(){this.gpuRenderPassEncoder.end(),this.gpuRenderPassEncoder=null;for(let t=0;t<this.gfxColorAttachment.length;t++){const r=this.gfxColorAttachment[t],i=this.gfxColorResolveTo[t];r!==null&&i!==null&&r.sampleCount===1&&this.copyAttachment(i,this.gfxColorAttachmentLevel[t],r,this.gfxColorResolveToLevel[t])}return this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.commandEncoder.finish()}copyAttachment(t,r,i,n){b(i.sampleCount===1);const s={texture:i.gpuTexture,mipLevel:n},o={texture:t.gpuTexture,mipLevel:r};b(i.width>>>n===t.width>>>r),b(i.height>>>n===t.height>>>r),b(!!(i.usage&le.COPY_SRC)),b(!!(t.usage&le.COPY_DST)),this.commandEncoder.copyTextureToTexture(s,o,[t.width,t.height,1])}}class sn extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.RenderPipeline,this.isCreatingAsync=!1,this.gpuRenderPipeline=null,this.descriptor=i,this.device.createRenderPipelineInternal(this,!1)}getBindGroupLayout(t){return this.gpuRenderPipeline.getBindGroupLayout(t)}}class on extends fe{constructor({id:t,device:r,descriptor:i}){super({id:t,device:r}),this.type=D.Sampler;const n=i.lodMinClamp,s=i.mipmapFilter===q.NO_MIP?i.lodMinClamp:i.lodMaxClamp,o=i.maxAnisotropy??1;o>1&&b(i.minFilter===Y.BILINEAR&&i.magFilter===Y.BILINEAR&&i.mipmapFilter===q.LINEAR),this.gpuSampler=this.device.device.createSampler({addressModeU:ft(i.addressModeU),addressModeV:ft(i.addressModeV),addressModeW:ft(i.addressModeW??i.addressModeU),lodMinClamp:n,lodMaxClamp:s,minFilter:Lt(i.minFilter),magFilter:Lt(i.magFilter),mipmapFilter:Fi(i.mipmapFilter),compare:i.compareFunction!==void 0?nt(i.compareFunction):void 0,maxAnisotropy:o})}}class et extends fe{constructor({id:t,device:r,descriptor:i,skipCreate:n,sampleCount:s}){super({id:t,device:r}),this.type=D.Texture;const{format:o,dimension:l,width:u,height:a,depthOrArrayLayers:_,mipLevelCount:E,usage:R}=i;this.device.createTextureShared({format:o,dimension:l??P.TEXTURE_2D,width:u,height:a,depthOrArrayLayers:_??1,mipLevelCount:E??1,usage:R,sampleCount:s??1},this,n)}textureFromImageBitmapOrCanvas(t,r,i){const n=r[0].width,s=r[0].height,o={size:{width:n,height:s,depthOrArrayLayers:i},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},l=t.createTexture(o);for(let u=0;u<r.length;u++)t.queue.copyExternalImageToTexture({source:r[u]},{texture:l,origin:[0,0,u]},[n,s]);return[l,n,s]}isImageBitmapOrCanvases(t){const r=t[0];return r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof OffscreenCanvas}isVideo(t){return t[0]instanceof HTMLVideoElement}setImageData(t,r=0){const{device:i}=this.device;let n,s,o;this.isImageBitmapOrCanvases(t)?[n,s,o]=this.textureFromImageBitmapOrCanvas(i,t,this.depthOrArrayLayers):this.isVideo(t)&&(n=i.importExternalTexture({source:t[0]})),this.width=s,this.height=o,this.gpuTexture=n,this.gpuTextureView=n.createView({dimension:Oi(this.dimension)})}destroy(){super.destroy(),this.gpuTexture.destroy()}}class an{constructor(t,r,i,n,s){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=le.RENDER_ATTACHMENT|le.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=_t.UPPER_LEFT,this.clipSpaceNearZ=Et.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=r,this.canvas=i,this.canvasContext=n,this.glsl_compile=s,this.fallbackTexture2D=this.createFallbackTexture(P.TEXTURE_2D,k.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(P.TEXTURE_2D,k.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(P.TEXTURE_2D_ARRAY,k.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(P.TEXTURE_3D,k.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(P.TEXTURE_CUBE_MAP,k.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:re.REPEAT,addressModeV:re.REPEAT,minFilter:Y.POINT,magFilter:Y.POINT,mipmapFilter:q.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:re.REPEAT,addressModeV:re.REPEAT,minFilter:Y.POINT,magFilter:Y.POINT,mipmapFilter:q.NEAREST,compareFunction:w.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=o=>{console.error(o.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}destroy(){}configureSwapChain(t,r){this.swapChainWidth===t&&this.swapChainHeight===r||(this.swapChainWidth=t,this.swapChainHeight=r)}getOnscreenTexture(){const t=this.canvasContext.getCurrentTexture(),r=t.createView(),i=new et({id:0,device:this,descriptor:{format:h.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:P.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return i.depthOrArrayLayers=1,i.sampleCount=1,i.gpuTexture=t,i.gpuTextureView=r,i.name="Onscreen",this.setResourceName(i,"Onscreen Texture"),i}getDevice(){return this}getCanvas(){return this.canvas}beginFrame(){}endFrame(){}getNextUniqueId(){return++this._resourceUniqueId}createBuffer(t){return new Qi({id:this.getNextUniqueId(),device:this,descriptor:t})}createTexture(t){return new et({id:this.getNextUniqueId(),device:this,descriptor:t})}createSampler(t){return new on({id:this.getNextUniqueId(),device:this,descriptor:t})}createRenderTarget(t){const r=new et({id:this.getNextUniqueId(),device:this,descriptor:{...t,dimension:P.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:x.RENDER_TARGET},sampleCount:t.sampleCount});return r.depthOrArrayLayers=1,r.type=D.RenderTarget,r}createRenderTargetFromTexture(t){const{format:r,width:i,height:n,depthOrArrayLayers:s,sampleCount:o,mipLevelCount:l,gpuTexture:u,gpuTextureView:a,usage:_}=t;b(!!(_&le.RENDER_ATTACHMENT));const E=new et({id:this.getNextUniqueId(),device:this,descriptor:{format:r,width:i,height:n,depthOrArrayLayers:s,dimension:P.TEXTURE_2D,mipLevelCount:l,usage:_},skipCreate:!0});return E.depthOrArrayLayers=s,E.sampleCount=o,E.gpuTexture=u,E.gpuTextureView=a,E}createProgram(t){var r,i;return(r=t.vertex)!=null&&r.glsl&&(t.vertex.glsl=ct(this.queryVendorInfo(),"vert",t.vertex.glsl)),(i=t.fragment)!=null&&i.glsl&&(t.fragment.glsl=ct(this.queryVendorInfo(),"frag",t.fragment.glsl)),new en({id:this.getNextUniqueId(),device:this,descriptor:t})}createTextureShared(t,r,i){const n={width:t.width,height:t.height,depthOrArrayLayers:t.depthOrArrayLayers},s=t.mipLevelCount,o=Mt(t.format),l=Mi(t.dimension),u=Ii(t.usage);if(r.gpuTextureformat=o,r.dimension=t.dimension,r.format=t.format,r.width=t.width,r.height=t.height,r.depthOrArrayLayers=t.depthOrArrayLayers,r.mipLevelCount=s,r.usage=u,r.sampleCount=t.sampleCount,!i){const a=this.device.createTexture({size:n,mipLevelCount:s,format:o,dimension:l,sampleCount:t.sampleCount,usage:u}),_=a.createView();r.gpuTexture=a,r.gpuTextureView=_}}getFallbackSampler(t){return t.formatKind===k.Depth&&t.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering}getFallbackTexture(t){const r=t.dimension,i=t.formatKind;if(r===P.TEXTURE_2D)return i===k.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===P.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===P.TEXTURE_3D)return this.fallbackTexture3D;if(r===P.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")}createFallbackTexture(t,r){const i=t===P.TEXTURE_CUBE_MAP?6:1,n=r===k.Float?h.U8_RGBA_NORM:h.D24;return this.createTexture({dimension:t,format:n,usage:x.SAMPLED,width:1,height:1,depthOrArrayLayers:i,mipLevelCount:1})}createBindings(t){return new qi({id:this.getNextUniqueId(),device:this,descriptor:t})}createInputLayout(t){return new Gi({id:this.getNextUniqueId(),device:this,descriptor:t})}createComputePipeline(t){return new Ji({id:this.getNextUniqueId(),device:this,descriptor:t})}createRenderPipeline(t){return new sn({id:this.getNextUniqueId(),device:this,descriptor:{...t}})}createQueryPool(t,r){return new tn({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})}createRenderPipelineInternal(t,r=!1){if(t.gpuRenderPipeline!==null)return;const i=t.descriptor,n=i.program,s=n.vertexStage,o=n.fragmentStage;if(s===null||o===null)return;const{stencilBack:l,stencilFront:u,...a}=i.megaStateDescriptor||{},_=je(Ve);i.megaStateDescriptor={..._,stencilBack:{..._.stencilBack,...l},stencilFront:{..._.stencilFront,...u},...a};const E=wi(i.topology??te.TRIANGLES,i.megaStateDescriptor),R=Hi(i.colorAttachmentFormats,i.megaStateDescriptor),d=ki(i.depthStencilAttachmentFormat,i.megaStateDescriptor);let f;i.inputLayout!==null&&(f=i.inputLayout.buffers);const p=i.sampleCount,T={layout:"auto",vertex:{...s,buffers:f},primitive:E,depthStencil:d,multisample:{count:p},fragment:{...o,targets:R}};t.gpuRenderPipeline=this.device.createRenderPipeline(T)}createReadback(){return new rn({id:this.getNextUniqueId(),device:this})}createRenderPass(t){let r=this.renderPassPool.pop();return r===void 0&&(r=new nn),r.commandEncoder=this.device.createCommandEncoder(),r.beginRenderPass(t),r}createComputePass(){let t=this.computePassPool.pop();return t===void 0&&(t=new Zi),t.commandEncoder=this.device.createCommandEncoder(),t.beginComputePass(),t}submitPass(t){const r=this.device.queue,i=t,n=i.finish();r.submit([n]),i.commandEncoder=null}copySubTexture2D(t,r,i,n,s,o){const l=this.device.createCommandEncoder(),u=t,a=n,_={texture:a.gpuTexture,origin:[s,o,0]},E={texture:u.gpuTexture,origin:[r,i,0]};b(!!(a.usage&le.COPY_SRC)),b(!!(u.usage&le.COPY_DST)),l.copyTextureToTexture(_,E,[a.width,a.height,1]),this.device.queue.submit([l.finish()])}queryLimits(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}}queryTextureFormatSupported(t,r,i){if(zi(t)){if(!this.featureTextureCompressionBC)return!1;const n=$i(t);return r%n!==0||i%n!==0?!1:this.featureTextureCompressionBC}switch(t){case h.U16_RGBA_NORM:return!1;case h.F32_RGBA:return!1}return!0}queryPlatformAvailable(){return!0}queryVendorInfo(){return this}queryRenderPass(t){return t.descriptor}queryRenderTarget(t){return t}setResourceName(t,r){if(t.name=r,t.type===D.Buffer){const i=t;i.gpuBuffer.label=r}else if(t.type===D.Texture){const i=t;i.gpuTexture.label=r,i.gpuTextureView.label=r}else if(t.type===D.RenderTarget){const i=t;i.gpuTexture.label=r,i.gpuTextureView.label=r}else if(t.type===D.Sampler){const i=t;i.gpuSampler.label=r}else if(t.type===D.RenderPipeline){const i=t;i.gpuRenderPipeline!==null&&(i.gpuRenderPipeline.label=r)}}setResourceLeakCheck(t,r){}checkForLeaks(){}programPatched(t){}pipelineQueryReady(t){return t.gpuRenderPipeline!==null}pipelineForceReady(t){const r=t;this.createRenderPipelineInternal(r,!1)}}class ln{constructor(t){this.pluginOptions=t}async createSwapChain(t){if(globalThis.navigator.gpu===void 0)return null;let r=null;try{const{xrCompatible:l}=this.pluginOptions;r=await globalThis.navigator.gpu.requestAdapter({xrCompatible:l})}catch(l){console.log(l)}if(r===null)return null;const n=["depth32float-stencil8","texture-compression-bc"].filter(l=>r.features.has(l)),s=await r.requestDevice({requiredFeatures:n});if(s){const{onContextLost:l}=this.pluginOptions;s.lost.then(()=>{l&&l()})}if(s===null)return null;const o=t.getContext("webgpu");if(!o)return null;try{await Er(this.pluginOptions.shaderCompilerPath)}catch{}return new an(r,s,t,o,mi)}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.16.0
 * @author George Michael Brower
 * @license MIT
 */class Re{constructor(t,r,i,n,s="div"){this.parent=t,this.object=r,this.property=i,this._disabled=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(n),this.$name=document.createElement("div"),this.$name.classList.add("name"),Re.nextNameID=Re.nextNameID||0,this.$name.id=`lil-gui-name-${++Re.nextNameID}`,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(t){return this._name=t,this.$name.innerHTML=t,this}onChange(t){return this._onChange=t,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return t===this._disabled?this:(this._disabled=t,this.domElement.classList.toggle("disabled",t),this.$disable.toggleAttribute("disabled",t),this)}options(t){const r=this.parent.add(this.object,this.property,t);return r.name(this._name),this.destroy(),r}min(t){return this}max(t){return this}step(t){return this}listen(t=!0){return this._listening=t,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback),this.updateDisplay()}getValue(){return this.object[this.property]}setValue(t){return this.object[this.property]=t,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(t){return this.setValue(t),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class cn extends Re{constructor(t,r,i){super(t,r,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function Ct(e){let t,r;return(t=e.match(/(#|0x)?([a-f0-9]{6})/i))?r=t[2]:(t=e.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?r=parseInt(t[1]).toString(16).padStart(2,0)+parseInt(t[2]).toString(16).padStart(2,0)+parseInt(t[3]).toString(16).padStart(2,0):(t=e.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(r=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),r?"#"+r:!1}const un={isPrimitive:!0,match:e=>typeof e=="string",fromHexString:Ct,toHexString:Ct},Qe={isPrimitive:!0,match:e=>typeof e=="number",fromHexString:e=>parseInt(e.substring(1),16),toHexString:e=>"#"+e.toString(16).padStart(6,0)},_n={isPrimitive:!1,match:Array.isArray,fromHexString(e,t,r=1){const i=Qe.fromHexString(e);t[0]=(i>>16&255)/255*r,t[1]=(i>>8&255)/255*r,t[2]=(i&255)/255*r},toHexString([e,t,r],i=1){i=255/i;const n=e*i<<16^t*i<<8^r*i<<0;return Qe.toHexString(n)}},En={isPrimitive:!1,match:e=>Object(e)===e,fromHexString(e,t,r=1){const i=Qe.fromHexString(e);t.r=(i>>16&255)/255*r,t.g=(i>>8&255)/255*r,t.b=(i&255)/255*r},toHexString({r:e,g:t,b:r},i=1){i=255/i;const n=e*i<<16^t*i<<8^r*i<<0;return Qe.toHexString(n)}},hn=[un,Qe,_n,En];function Rn(e){return hn.find(t=>t.match(e))}class dn extends Re{constructor(t,r,i,n){super(t,r,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=Rn(this.initialValue),this._rgbScale=n,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=Ct(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(t){if(this._format.isPrimitive){const r=this._format.fromHexString(t);this.setValue(r)}else this._format.fromHexString(t,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(t){return this._setValueFromHexString(t),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Tt extends Re{constructor(t,r,i){super(t,r,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",n=>{n.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{}),this.$disable=this.$button}}class An extends Re{constructor(t,r,i,n,s,o){super(t,r,i,"number"),this._initInput(),this.min(n),this.max(s);const l=o!==void 0;this.step(l?o:this._getImplicitStep(),l),this.updateDisplay()}min(t){return this._min=t,this._onUpdateMinMax(),this}max(t){return this._max=t,this._onUpdateMinMax(),this}step(t,r=!0){return this._step=t,this._stepExplicit=r,this}updateDisplay(){const t=this.getValue();if(this._hasSlider){let r=(t-this._min)/(this._max-this._min);r=Math.max(0,Math.min(r,1)),this.$fill.style.width=r*100+"%"}return this._inputFocused||(this.$input.value=t),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=()=>{const A=parseFloat(this.$input.value);isNaN(A)||this.setValue(this._clamp(A))},r=A=>{const m=parseFloat(this.$input.value);isNaN(m)||(this._snapClampSetValue(m+A),this.$input.value=this.getValue())},i=A=>{A.code==="Enter"&&this.$input.blur(),A.code==="ArrowUp"&&(A.preventDefault(),r(this._step*this._arrowKeyMultiplier(A))),A.code==="ArrowDown"&&(A.preventDefault(),r(this._step*this._arrowKeyMultiplier(A)*-1))},n=A=>{this._inputFocused&&(A.preventDefault(),r(this._step*this._normalizeMouseWheel(A)))};let s=!1,o,l,u,a,_;const E=5,R=A=>{o=A.clientX,l=u=A.clientY,s=!0,a=this.getValue(),_=0,window.addEventListener("mousemove",d),window.addEventListener("mouseup",f)},d=A=>{if(s){const m=A.clientX-o,g=A.clientY-l;Math.abs(g)>E?(A.preventDefault(),this.$input.blur(),s=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(m)>E&&f()}if(!s){const m=A.clientY-u;_-=m*this._step*this._arrowKeyMultiplier(A),a+_>this._max?_=this._max-a:a+_<this._min&&(_=this._min-a),this._snapClampSetValue(a+_)}u=A.clientY},f=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",f)},p=()=>{this._inputFocused=!0},T=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",t),this.$input.addEventListener("keydown",i),this.$input.addEventListener("wheel",n),this.$input.addEventListener("mousedown",R),this.$input.addEventListener("focus",p),this.$input.addEventListener("blur",T)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=(A,m,g,B,C)=>(A-m)/(g-m)*(C-B)+B,r=A=>{const m=this.$slider.getBoundingClientRect();let g=t(A,m.left,m.right,this._min,this._max);this._snapClampSetValue(g)},i=A=>{this._setDraggingStyle(!0),r(A.clientX),window.addEventListener("mousemove",n),window.addEventListener("mouseup",s)},n=A=>{r(A.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",s)};let o=!1,l,u;const a=A=>{A.preventDefault(),this._setDraggingStyle(!0),r(A.touches[0].clientX),o=!1},_=A=>{A.touches.length>1||(this._hasScrollBar?(l=A.touches[0].clientX,u=A.touches[0].clientY,o=!0):a(A),window.addEventListener("touchmove",E),window.addEventListener("touchend",R))},E=A=>{if(o){const m=A.touches[0].clientX-l,g=A.touches[0].clientY-u;Math.abs(m)>Math.abs(g)?a(A):(window.removeEventListener("touchmove",E),window.removeEventListener("touchend",R))}else A.preventDefault(),r(A.touches[0].clientX)},R=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",E),window.removeEventListener("touchend",R)},d=this._callOnFinishChange.bind(this),f=400;let p;const T=A=>{if(Math.abs(A.deltaX)<Math.abs(A.deltaY)&&this._hasScrollBar)return;A.preventDefault();const g=this._normalizeMouseWheel(A)*this._step;this._snapClampSetValue(this.getValue()+g),this.$input.value=this.getValue(),clearTimeout(p),p=setTimeout(d,f)};this.$slider.addEventListener("mousedown",i),this.$slider.addEventListener("touchstart",_),this.$slider.addEventListener("wheel",T)}_setDraggingStyle(t,r="horizontal"){this.$slider&&this.$slider.classList.toggle("active",t),document.body.classList.toggle("lil-gui-dragging",t),document.body.classList.toggle(`lil-gui-${r}`,t)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(t){let{deltaX:r,deltaY:i}=t;return Math.floor(t.deltaY)!==t.deltaY&&t.wheelDelta&&(r=0,i=-t.wheelDelta/120,i*=this._stepExplicit?1:10),r+-i}_arrowKeyMultiplier(t){let r=this._stepExplicit?1:10;return t.shiftKey?r*=10:t.altKey&&(r/=10),r}_snap(t){const r=Math.round(t/this._step)*this._step;return parseFloat(r.toPrecision(15))}_clamp(t){return t<this._min&&(t=this._min),t>this._max&&(t=this._max),t}_snapClampSetValue(t){this.setValue(this._clamp(this._snap(t)))}get _hasScrollBar(){const t=this.parent.root.$children;return t.scrollHeight>t.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class fn extends Re{constructor(t,r,i,n){super(t,r,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(n)?n:Object.values(n),this._names=Array.isArray(n)?n:Object.keys(n),this._names.forEach(s=>{const o=document.createElement("option");o.innerHTML=s,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const t=this.getValue(),r=this._values.indexOf(t);return this.$select.selectedIndex=r,this.$display.innerHTML=r===-1?t:this._names[r],this}}class Tn extends Re{constructor(t,r,i){super(t,r,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",n=>{n.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}const pn=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "↕";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "▾";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "▸";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "✓";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function gn(e){const t=document.createElement("style");t.innerHTML=e;const r=document.querySelector("head link[rel=stylesheet], head style");r?document.head.insertBefore(t,r):document.head.appendChild(t)}let jt=!1;class Ot{constructor({parent:t,autoPlace:r=t===void 0,container:i,width:n,title:s="Controls",injectStyles:o=!0,touchStyles:l=!0}={}){if(this.parent=t,this.root=t?t.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",u=>{(u.code==="Enter"||u.code==="Space")&&(u.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),l&&this.domElement.classList.add("allow-touch-styles"),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),!jt&&o&&(gn(pn),jt=!0),i?i.appendChild(this.domElement):r&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),n&&this.domElement.style.setProperty("--width",n+"px"),this.domElement.addEventListener("keydown",u=>u.stopPropagation()),this.domElement.addEventListener("keyup",u=>u.stopPropagation())}add(t,r,i,n,s){if(Object(i)===i)return new fn(this,t,r,i);const o=t[r];switch(typeof o){case"number":return new An(this,t,r,i,n,s);case"boolean":return new cn(this,t,r);case"string":return new Tn(this,t,r);case"function":return new Tt(this,t,r)}console.error(`gui.add failed
	property:`,r,`
	object:`,t,`
	value:`,o)}addColor(t,r,i=1){return new dn(this,t,r,i)}addFolder(t){return new Ot({parent:this,title:t})}load(t,r=!0){return t.controllers&&this.controllers.forEach(i=>{i instanceof Tt||i._name in t.controllers&&i.load(t.controllers[i._name])}),r&&t.folders&&this.folders.forEach(i=>{i._title in t.folders&&i.load(t.folders[i._title])}),this}save(t=!0){const r={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof Tt)){if(i._name in r.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);r.controllers[i._name]=i.save()}}),t&&this.folders.forEach(i=>{if(i._title in r.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);r.folders[i._title]=i.save()}),r}open(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const r=this.$children.clientHeight;this.$children.style.height=r+"px",this.domElement.classList.add("transition");const i=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const n=t?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!t),requestAnimationFrame(()=>{this.$children.style.height=n+"px"})}),this}title(t){return this._title=t,this.$title.innerHTML=t,this}reset(t=!0){return(t?this.controllersRecursive():this.controllers).forEach(i=>i.reset()),this}onChange(t){return this._onChange=t,this}_callOnChange(t){this.parent&&this.parent._callOnChange(t),this._onChange!==void 0&&this._onChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(t){this.parent&&this.parent._callOnFinishChange(t),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(t=>t.destroy())}controllersRecursive(){let t=Array.from(this.controllers);return this.folders.forEach(r=>{t=t.concat(r.controllersRecursive())}),t}foldersRecursive(){let t=Array.from(this.folders);return this.folders.forEach(r=>{t=t.concat(r.foldersRecursive())}),t}}async function ne(e,t,r){const i=new Wt({targets:["webgl1"],xrCompatible:r.xrCompatible,onContextCreationError:()=>{},onContextLost:()=>{},onContextRestored(E){}}),n=new Wt({targets:["webgl2","webgl1"],xrCompatible:r.xrCompatible,onContextCreationError:()=>{},onContextLost:()=>{},onContextRestored(E){}}),s=new ln({shaderCompilerPath:"/glsl_wgsl_compiler_bg.wasm"});let o;const l=async(E,R)=>{let d=document.getElementById("canvas");d&&d.remove(),d=document.createElement("div"),d.id="canvas",R.appendChild(d),d.innerHTML="";const f=document.createElement("canvas");f.width=1e3,f.height=1e3,f.style.width="500px",f.style.height="500px",d.appendChild(f),o=await t(E,f)};r.default==="webgl1"?await l(i,e):r.default==="webgl2"?await l(n,e):r.default==="webgpu"&&await l(s,e);const u=new Ot({autoPlace:!1});e.appendChild(u.domElement);const a=u.addFolder("renderer"),_={renderer:r.default};return a.add(_,"renderer",r.targets).onChange(async E=>{o&&(o(),o=void 0),E==="webgl1"?o=await l(i,e):E==="webgl2"?o=await l(n,e):E==="webgpu"&&(o=await l(s,e))}),a.open(),o}async function Rr(e){if(window.createImageBitmap){const t=await fetch(e);return await createImageBitmap(await t.blob())}else{const t=new window.Image;return new Promise(r=>{t.onload=()=>r(t),t.src=e,t.crossOrigin="Anonymous"})}}async function Sn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=i.getOnscreenTexture(),o=n.createProgram({vertex:{glsl:`
layout(location = 0) in vec2 a_Position;

void main() {
  gl_Position = vec4(a_Position, 0.0, 1.0);
  gl_PointSize = 10.0;
} 
`},fragment:{glsl:`
out vec4 outputColor;

void main() {
  outputColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`}}),l=n.createBuffer({viewOrSize:new Float32Array([0,.5,-.5,-.5,.5,-.5]),usage:M.VERTEX,hint:K.DYNAMIC}),u=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG}]}],indexBufferFormat:null,program:o}),a=n.createRenderPipeline({inputLayout:u,program:o,topology:te.POINTS,colorAttachmentFormats:[h.U8_RGBA_RT]}),_=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET}));let E;const R=()=>{const d=n.createRenderPass({colorAttachment:[_],colorResolveTo:[s],colorClearColor:[ie]});d.setPipeline(a),d.setVertexInput(u,[{buffer:l}],null),d.setViewport(0,0,t.width,t.height),d.draw(3),n.submitPass(d),r&&requestAnimationFrame(R)};return R(),()=>{r&&E&&cancelAnimationFrame(E),o.destroy(),l.destroy(),u.destroy(),a.destroy(),_.destroy(),n.destroy(),n.checkForLeaks()}}async function mn(e){return ne(e,Sn,{targets:["webgl1","webgl2"],default:"webgl2"})}async function Cn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(location = 0) in vec2 a_Position;

void main() {
  gl_Position = vec4(a_Position, 0.0, 1.0);
} 
`},fragment:{glsl:`
out vec4 outputColor;

void main() {
  outputColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`}}),o=n.createBuffer({viewOrSize:new Float32Array([0,.5,-.5,-.5,.5,-.5]),usage:M.VERTEX,hint:K.DYNAMIC});n.setResourceName(o,"a_Position");const l=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG}]}],indexBufferFormat:null,program:s}),u=n.createRenderPipeline({inputLayout:l,program:s,colorAttachmentFormats:[h.U8_RGBA_RT]}),a=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET}));n.setResourceName(a,"Main Render Target");let _;const E=()=>{const R=i.getOnscreenTexture(),d=n.createRenderPass({colorAttachment:[a],colorResolveTo:[R],colorClearColor:[ie]});d.setPipeline(u),d.setVertexInput(l,[{buffer:o}],null),d.setViewport(0,0,t.width,t.height),d.draw(3),n.submitPass(d),r&&(_=requestAnimationFrame(E))};return E(),()=>{r&&_&&cancelAnimationFrame(_),s.destroy(),o.destroy(),l.destroy(),u.destroy(),a.destroy(),n.destroy(),n.checkForLeaks()}}async function Nn(e){return ne(e,Cn,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}async function Bn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(location = 0) in vec2 a_Position;

void main() {
  gl_Position = vec4(a_Position, 0.0, 1.0);
} 
`},fragment:{glsl:`
out vec4 outputColor;

void main() {
  outputColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`}}),o=n.createBuffer({viewOrSize:new Float32Array([0,.5,-.5,-.5,.5,-.5]),usage:M.VERTEX,hint:K.DYNAMIC});n.setResourceName(o,"a_Position");const l=n.createBuffer({viewOrSize:new Uint32Array([0,1,2]),usage:M.INDEX,hint:K.STATIC}),u=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG}]}],indexBufferFormat:h.U32_R,program:s}),a=n.createRenderPipeline({inputLayout:u,program:s,colorAttachmentFormats:[h.U8_RGBA_RT]}),_=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET}));n.setResourceName(_,"Main Render Target");let E;const R=()=>{const d=i.getOnscreenTexture(),f=n.createRenderPass({colorAttachment:[_],colorResolveTo:[d],colorClearColor:[ie]});f.setPipeline(a),f.setVertexInput(u,[{buffer:o}],{buffer:l}),f.setViewport(0,0,t.width,t.height),f.draw(3),n.submitPass(f),r&&(E=requestAnimationFrame(R))};return R(),()=>{r&&E&&cancelAnimationFrame(E),s.destroy(),o.destroy(),l.destroy(),u.destroy(),a.destroy(),_.destroy(),n.destroy(),n.checkForLeaks()}}async function In(e){return ne(e,Bn,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}async function Mn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(location = 0) in vec2 a_Position;

void main() {
  gl_Position = vec4(a_Position, 0.0, 1.0);
} 
`},fragment:{glsl:`
out vec4 outputColor;

void main() {
  outputColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`}}),o=n.createBuffer({viewOrSize:new Float32Array([0,.5,-.5,-.5,.5,-.5]),usage:M.VERTEX,hint:K.DYNAMIC});n.setResourceName(o,"a_Position");const l=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG}]}],indexBufferFormat:null,program:s}),u=n.createRenderPipeline({inputLayout:l,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],sampleCount:4}),a=n.createRenderTarget({format:h.U8_RGBA_RT,width:t.width,height:t.height,sampleCount:4});n.setResourceName(a,"Main Render Target");let _;const E=()=>{const R=i.getOnscreenTexture(),d=n.createRenderPass({colorAttachment:[a],colorResolveTo:[R],colorClearColor:[ie]});d.setPipeline(u),d.setVertexInput(l,[{buffer:o}],null),d.setViewport(0,0,t.width,t.height),d.draw(3),n.submitPass(d),r&&(_=requestAnimationFrame(E))};return E(),()=>{r&&_&&cancelAnimationFrame(_),s.destroy(),o.destroy(),l.destroy(),u.destroy(),a.destroy(),n.destroy(),n.checkForLeaks()}}async function On(e){return ne(e,Mn,{targets:["webgl2","webgpu"],default:"webgl2"})}const Me=4*10,bt=0,dr=4*8,me=36,Oe=new Float32Array([1,-1,1,1,1,0,1,1,0,1,-1,-1,1,1,0,0,1,1,1,1,-1,-1,-1,1,0,0,0,1,1,0,1,-1,-1,1,1,0,0,1,0,0,1,-1,1,1,1,0,1,1,0,1,-1,-1,-1,1,0,0,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,-1,1,1,1,0,1,1,1,1,1,-1,-1,1,1,0,0,1,1,0,1,1,-1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,1,0,1,1,-1,-1,1,1,0,0,1,1,0,-1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,0,1,1,0,-1,1,-1,1,0,1,0,1,0,0,-1,1,1,1,0,1,1,1,0,1,1,1,-1,1,1,1,0,1,1,0,-1,-1,1,1,0,0,1,1,0,1,-1,1,1,1,0,1,1,1,1,1,-1,1,-1,1,0,1,0,1,1,0,-1,-1,-1,1,0,0,0,1,0,0,-1,-1,1,1,0,0,1,1,0,1,-1,1,-1,1,0,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,-1,1,1,1,0,1,1,1,1,1,-1,-1,1,1,0,0,1,1,1,0,-1,-1,1,1,0,0,1,1,1,0,1,-1,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,-1,-1,1,1,0,0,1,0,1,-1,-1,-1,1,0,0,0,1,1,1,-1,1,-1,1,0,1,0,1,1,0,1,1,-1,1,1,1,0,1,0,0,1,-1,-1,1,1,0,0,1,0,1,-1,1,-1,1,0,1,0,1,1,0]);async function bn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec3 a_Position;

out vec4 v_Position;

void main() {
  v_Position = vec4(a_Position, 1.0);
  gl_Position = u_ModelViewProjectionMatrix * vec4(a_Position, 1.0);
} 
`},fragment:{glsl:`
in vec4 v_Position;
out vec4 outputColor;

void main() {
  outputColor = v_Position;
}
`}}),o=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),l=n.createBuffer({viewOrSize:16*4,usage:M.UNIFORM,hint:K.DYNAMIC}),u=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RGB}]}],indexBufferFormat:null,program:s}),a=n.createRenderPipeline({inputLayout:u,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1}}),_=n.createBindings({pipeline:a,uniformBufferBindings:[{binding:0,buffer:l,size:16*4}]}),E=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),R=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET}));let d;const f=()=>{const p=t.width/t.height,T=Fe(v(),2*Math.PI/5,p,.1,1e3),A=Ze(v()),m=v();ht(A,A,J(0,0,-4));const g=r?Date.now()/1e3:0;Se(A,A,1,J(Math.sin(g),Math.cos(g),0)),ue(m,T,A),l.setSubData(0,new Uint8Array(m.buffer)),s.setUniformsLegacy({u_ModelViewProjectionMatrix:m});const B=i.getOnscreenTexture(),C=n.createRenderPass({colorAttachment:[E],colorResolveTo:[B],colorClearColor:[ie],depthStencilAttachment:R,depthClearValue:1});C.setPipeline(a),C.setVertexInput(u,[{buffer:o}],null),C.setViewport(0,0,t.width,t.height),C.setBindings(_),C.draw(me),n.submitPass(C),r&&(d=requestAnimationFrame(f))};return f(),()=>{r&&d&&cancelAnimationFrame(d),s.destroy(),o.destroy(),l.destroy(),u.destroy(),_.destroy(),a.destroy(),E.destroy(),R.destroy(),n.destroy(),n.checkForLeaks()}}async function Fn(e){return ne(e,bn,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}async function Pn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(location = 0) in vec2 a_Position;

void main() {
  gl_Position = vec4(a_Position, 0.0, 1.0);
} 
`},fragment:{glsl:`
out vec4 outputColor;

void main() {
  outputColor = vec4(0.0, 0.0, 0.0, 0.0);
}
`}}),o=n.createBuffer({viewOrSize:new Float32Array([0,.5,-.5,-.5,.5,-.5]),usage:M.VERTEX,hint:K.DYNAMIC}),l=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG}]}],indexBufferFormat:null,program:s}),u=n.createRenderPipeline({inputLayout:l,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!1,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!0,stencilFront:{compare:w.ALWAYS,passOp:Q.REPLACE},stencilBack:{compare:w.ALWAYS,passOp:Q.REPLACE}}}),a=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec3 a_Position;

out vec4 v_Position;

void main() {
  v_Position = vec4(a_Position, 1.0);
  gl_Position = u_ModelViewProjectionMatrix * vec4(a_Position, 1.0);
}
`},fragment:{glsl:`
  in vec4 v_Position;
  out vec4 outputColor;
  
  void main() {
    outputColor = v_Position;
  }
  `}}),_=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),E=n.createBuffer({viewOrSize:16*4,usage:M.UNIFORM,hint:K.DYNAMIC}),R=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RGB}]}],indexBufferFormat:null,program:a}),d=n.createRenderPipeline({inputLayout:R,program:a,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1,stencilFront:{compare:w.EQUAL,passOp:Q.KEEP},stencilBack:{compare:w.EQUAL,passOp:Q.KEEP}}}),f=n.createBindings({pipeline:d,uniformBufferBindings:[{binding:0,buffer:E,size:16*4}]}),p=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),T=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET}));let A;const m=()=>{const g=t.width/t.height,B=Fe(v(),2*Math.PI/5,g,.1,1e3),C=Ze(v()),N=v();ht(C,C,J(0,0,-4));const V=r?Date.now()/1e3:0;Se(C,C,1,J(Math.sin(V),Math.cos(V),0)),ue(N,B,C),E.setSubData(0,new Uint8Array(N.buffer)),a.setUniformsLegacy({u_ModelViewProjectionMatrix:N});const y=i.getOnscreenTexture(),U=n.createRenderPass({colorAttachment:[p],colorResolveTo:[y],colorClearColor:[ie],depthStencilAttachment:T,depthClearValue:1,stencilClearValue:0});U.setPipeline(u),U.setVertexInput(l,[{buffer:o}],null),U.setViewport(0,0,t.width,t.height),U.setStencilReference(1),U.draw(3),U.setPipeline(d),U.setVertexInput(R,[{buffer:_}],null),U.setBindings(f),U.setStencilReference(1),U.draw(me),n.submitPass(U),r&&(A=requestAnimationFrame(m))};return m(),()=>{r&&A&&cancelAnimationFrame(A),a.destroy(),_.destroy(),E.destroy(),R.destroy(),f.destroy(),d.destroy(),p.destroy(),T.destroy(),s.destroy(),l.destroy(),u.destroy(),o.destroy(),n.destroy(),n.checkForLeaks()}}async function Dn(e){return ne(e,Pn,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}async function Un(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec3 a_Position;

out vec4 v_Position;

void main() {
  v_Position = vec4(a_Position, 1.0);
  gl_Position = u_ModelViewProjectionMatrix * vec4(a_Position, 1.0);
} 
`},fragment:{glsl:`
in vec4 v_Position;
out vec4 outputColor;

void main() {
  outputColor = v_Position;
}
`}}),o=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),l=n.createBuffer({viewOrSize:16*4,usage:M.UNIFORM,hint:K.DYNAMIC}),u=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RGB}]}],indexBufferFormat:null,program:s}),a=n.createRenderPipeline({inputLayout:u,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1}}),_=n.createBindings({pipeline:a,uniformBufferBindings:[{binding:0,buffer:l,size:16*4}]}),E=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),R=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET}));let d;const f=()=>{const p=t.width/t.height,T=Fe(v(),2*Math.PI/5,p,.1,1e3),A=Ze(v()),m=v();ht(A,A,J(0,0,-4));const g=r?Date.now()/1e3:0;Se(A,A,1,J(Math.sin(g),Math.cos(g),0)),ue(m,T,A),l.setSubData(0,new Uint8Array(m.buffer)),s.setUniformsLegacy({u_ModelViewProjectionMatrix:m});const B=i.getOnscreenTexture(),C=n.createRenderPass({colorAttachment:[E],colorResolveTo:[B],colorClearColor:[ie],depthStencilAttachment:R,depthClearValue:1});C.setPipeline(a),C.setVertexInput(u,[{buffer:o}],null),C.setViewport(0,0,t.width,t.height),C.setBindings(_),C.setScissorRect(0,0,500,500),C.draw(me),n.submitPass(C),r&&(d=requestAnimationFrame(f))};return f(),()=>{r&&d&&cancelAnimationFrame(d),s.destroy(),o.destroy(),l.destroy(),u.destroy(),_.destroy(),a.destroy(),E.destroy(),R.destroy(),n.destroy(),n.checkForLeaks()}}async function xn(e){return ne(e,Un,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}async function vn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec4 a_Position;

out vec4 v_Position;

void main() {
  v_Position = 0.5 * (a_Position + vec4(1.0, 1.0, 1.0, 1.0));
  gl_Position = u_ModelViewProjectionMatrix * a_Position;
} 
`},fragment:{glsl:`
in vec4 v_Position;
out vec4 outputColor;

void main() {
  outputColor = v_Position;
}
`}}),o=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),l=4*16,u=256,a=u+l,_=n.createBuffer({viewOrSize:a,usage:M.UNIFORM,hint:K.DYNAMIC}),E=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:bt,format:h.F32_RGBA}]}],indexBufferFormat:null,program:s}),R=n.createRenderPipeline({inputLayout:E,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1}}),d=n.createBindings({pipeline:R,uniformBufferBindings:[{binding:0,buffer:_,offset:0,size:l}]}),f=n.createBindings({pipeline:R,uniformBufferBindings:[{binding:0,buffer:_,offset:u,size:l}]}),p=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),T=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET})),A=ze(v(),J(-2,0,0)),m=ze(v(),J(2,0,0)),g=v(),B=v(),C=ze(v(),J(0,0,-7)),N=v(),V=v();let y;const U=()=>{const L=t.width/t.height,se=Fe(v(),2*Math.PI/5,L,1,100),j=r?Date.now()/1e3:0;Se(N,A,1,J(Math.sin(j),Math.cos(j),0)),Se(V,m,1,J(Math.cos(j),Math.sin(j),0)),ue(g,C,N),ue(g,se,g),ue(B,C,V),ue(B,se,B),_.setSubData(0,new Uint8Array(g.buffer)),_.setSubData(u,new Uint8Array(B.buffer));const oe=i.getOnscreenTexture(),z=n.createRenderPass({colorAttachment:[p],colorResolveTo:[oe],colorClearColor:[ie],depthStencilAttachment:T,depthClearValue:1});z.setPipeline(R),z.setVertexInput(E,[{buffer:o}],null),z.setViewport(0,0,t.width,t.height),z.setBindings(d),z.draw(me),z.setBindings(f),z.draw(me),n.submitPass(z),r&&(y=requestAnimationFrame(U))};return U(),()=>{r&&y&&cancelAnimationFrame(y),s.destroy(),o.destroy(),_.destroy(),E.destroy(),d.destroy(),f.destroy(),R.destroy(),p.destroy(),T.destroy(),n.destroy(),n.checkForLeaks()}}async function yn(e){return ne(e,vn,{targets:["webgl2","webgpu"],default:"webgl2"})}async function wn(e,t,r=!0,i){const n=await e.createSwapChain(t);n.configureSwapChain(t.width,t.height);const s=n.getDevice(),o=s.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec4 a_Position;
layout(location = 1) in vec2 a_Uv;

out vec2 v_Uv;

void main() {
  v_Uv = a_Uv;
  gl_Position = u_ModelViewProjectionMatrix * a_Position;
} 
`},fragment:{glsl:`
uniform sampler2D u_Texture;
in vec2 v_Uv;
out vec4 outputColor;

void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_Uv);
}
`}}),l=s.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),u=s.createBuffer({viewOrSize:16*4,usage:M.UNIFORM,hint:K.DYNAMIC}),a=i??await Rr("https://gw.alipayobjects.com/mdn/rms_6ae20b/afts/img/A*_aqoS73Se3sAAAAAAAAAAAAAARQnAQ"),_=s.createTexture({format:h.U8_RGBA_NORM,width:a.width,height:a.height,usage:x.SAMPLED});_.setImageData([a]);const E=s.createSampler({addressModeU:re.CLAMP_TO_EDGE,addressModeV:re.CLAMP_TO_EDGE,minFilter:Y.POINT,magFilter:Y.BILINEAR,mipmapFilter:q.LINEAR,lodMinClamp:0,lodMaxClamp:0}),R=s.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:bt,format:h.F32_RGBA},{shaderLocation:1,offset:dr,format:h.F32_RG}]}],indexBufferFormat:null,program:o}),d=s.createRenderPipeline({inputLayout:R,program:o,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1}}),f=s.createBindings({pipeline:d,uniformBufferBindings:[{binding:0,buffer:u,size:16*4}],samplerBindings:[{texture:_,sampler:E}]}),p=s.createRenderTargetFromTexture(s.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),T=s.createRenderTargetFromTexture(s.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET}));let A;const m=()=>{const g=t.width/t.height,B=Fe(v(),2*Math.PI/5,g,.1,1e3),C=Ze(v()),N=v();ht(C,C,J(0,0,-4));const V=r?Date.now()/1e3:0;Se(C,C,1,J(Math.sin(V),Math.cos(V),0)),ue(N,B,C),u.setSubData(0,new Uint8Array(N.buffer)),o.setUniformsLegacy({u_ModelViewProjectionMatrix:N,u_Texture:_});const y=n.getOnscreenTexture(),U=s.createRenderPass({colorAttachment:[p],colorResolveTo:[y],colorClearColor:[ie],depthStencilAttachment:T,depthClearValue:1});U.setPipeline(d),U.setVertexInput(R,[{buffer:l}],null),U.setViewport(0,0,t.width,t.height),U.setBindings(f),U.draw(me),s.submitPass(U),r&&(A=requestAnimationFrame(m))};return m(),()=>{r&&A&&cancelAnimationFrame(A),o.destroy(),l.destroy(),u.destroy(),R.destroy(),f.destroy(),d.destroy(),p.destroy(),T.destroy(),_.destroy(),E.destroy(),s.destroy(),s.checkForLeaks()}}async function Xn(e){return ne(e,wn,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}const qt=4,Qt=16;async function Vn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createTexture({format:h.U8_RGBA_RT,usage:x.SAMPLED,width:Qt,height:Qt,mipLevelCount:4}),o=[[255,255,255,255],[30,136,229,255],[255,193,7,255],[216,27,96,255]];for(let f=0;f<qt;++f){const p=2**(qt-f),T=new Uint8Array(p*p*4);for(let A=0;A<p;++A)for(let m=0;m<p;++m)T.set((m+A)%2?o[f]:[0,0,0,255],(A*p+m)*4);s.setImageData([T],f)}const l=n.createProgram({vertex:{wgsl:`
struct Config {
  viewProj: mat4x4f,
  animationOffset: vec2f,
  flangeSize: f32,
  highlightFlange: f32,
};
@group(0) @binding(0) var<uniform> config: Config;
@group(0) @binding(1) var<storage, read> matrices: array<mat4x4f>;
@group(0) @binding(2) var samp: sampler;
@group(0) @binding(3) var tex: texture_2d<f32>;

struct Varying {
  @builtin(position) pos: vec4f,
  @location(0) uv: vec2f,
}

override kTextureBaseSize: f32;
override kViewportSize: f32;

@vertex
fn vmain(
  @builtin(instance_index) instance_index: u32,
  @builtin(vertex_index) vertex_index: u32,
) -> Varying {
  let flange = config.flangeSize;
  var uvs = array(
    vec2(-flange, -flange), vec2(-flange, 1 + flange), vec2(1 + flange, -flange),
    vec2(1 + flange, -flange), vec2(-flange, 1 + flange), vec2(1 + flange, 1 + flange),
  );
  // Default size (if matrix is the identity) makes 1 texel = 1 pixel.
  let radius = (1 + 2 * flange) * kTextureBaseSize / kViewportSize;
  var positions = array(
    vec2(-radius, -radius), vec2(-radius, radius), vec2(radius, -radius),
    vec2(radius, -radius), vec2(-radius, radius), vec2(radius, radius),
  );

  let modelMatrix = matrices[instance_index];
  let pos = config.viewProj * modelMatrix * vec4f(positions[vertex_index] + config.animationOffset, 0, 1);
  return Varying(pos, uvs[vertex_index]);
}
`},fragment:{wgsl:`
out vec4 outputColor;

void main() {
  outputColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`}}),u=n.createBuffer({viewOrSize:new Float32Array([0,.5,-.5,-.5,.5,-.5]),usage:M.VERTEX,hint:K.DYNAMIC});n.setResourceName(u,"a_Position");const a=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG}]}],indexBufferFormat:null,program:l}),_=n.createRenderPipeline({inputLayout:a,program:l,colorAttachmentFormats:[h.U8_RGBA_RT]}),E=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET}));n.setResourceName(E,"Main Render Target");let R;const d=()=>{const f=i.getOnscreenTexture(),p=n.createRenderPass({colorAttachment:[E],colorResolveTo:[f],colorClearColor:[ie]});p.setPipeline(_),p.setVertexInput(a,[{buffer:u}],null),p.setViewport(0,0,t.width,t.height),p.draw(3),n.submitPass(p),r&&(R=requestAnimationFrame(d))};return d(),()=>{r&&R&&cancelAnimationFrame(R),l.destroy(),u.destroy(),a.destroy(),_.destroy(),E.destroy(),n.destroy(),n.checkForLeaks()}}async function Wn(e){return ne(e,Vn,{targets:["webgl1","webgl2","webgpu"],default:"webgpu"})}async function Hn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix[16];
};

layout(location = 0) in vec3 a_Position;

out vec4 v_Position;

void main() {
  v_Position = vec4(a_Position, 1.0);
  gl_Position = u_ModelViewProjectionMatrix[gl_InstanceID] * vec4(a_Position, 1.0);
} 
`},fragment:{glsl:`
in vec4 v_Position;
out vec4 outputColor;

void main() {
  outputColor = v_Position;
}
`}}),o=4,l=4,u=o*l,a=16,_=4*a,E=u*_,R=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),d=n.createBuffer({viewOrSize:E,usage:M.UNIFORM,hint:K.DYNAMIC}),f=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RGB}]}],indexBufferFormat:null,program:s}),p=n.createRenderPipeline({inputLayout:f,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1}}),T=n.createBindings({pipeline:p,uniformBufferBindings:[{binding:0,buffer:d,size:_*u}]}),A=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),m=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET})),g=t.width/t.height,B=Fe(v(),2*Math.PI/5,g,1,100),C=new Array(u),N=new Float32Array(a*u),V=4;let y=0;for(let oe=0;oe<o;oe++)for(let z=0;z<l;z++)C[y]=ze(v(),J(V*(oe-o/2+.5),V*(z-l/2+.5),0)),y++;const U=ze(v(),J(0,0,-12)),L=v();let se;const j=()=>{const oe=Date.now()/1e3;let z=0,Ne=0;for(let Rt=0;Rt<o;Rt++)for(let dt=0;dt<l;dt++)Se(L,C[Ne],1,J(Math.sin((Rt+.5)*oe),Math.cos((dt+.5)*oe),0)),ue(L,U,L),ue(L,B,L),N.set(L,z),Ne++,z+=a;d.setSubData(0,new Uint8Array(N.buffer));const fr=i.getOnscreenTexture(),Pe=n.createRenderPass({colorAttachment:[A],colorResolveTo:[fr],colorClearColor:[ie],depthStencilAttachment:m,depthClearValue:1});Pe.setPipeline(p),Pe.setVertexInput(f,[{buffer:R}],null),Pe.setViewport(0,0,t.width,t.height),Pe.setBindings(T),Pe.draw(me,u),n.submitPass(Pe),se=requestAnimationFrame(j)};return j(),()=>{r&&se&&cancelAnimationFrame(se),s.destroy(),R.destroy(),d.destroy(),f.destroy(),T.destroy(),p.destroy(),A.destroy(),m.destroy(),n.destroy(),n.checkForLeaks()}}async function kn(e){return ne(e,Hn,{targets:["webgl2","webgpu"],default:"webgl2"})}async function Ln(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec4 a_Position;
layout(location = 1) in vec2 a_Uv;

out vec2 v_Uv;
out vec4 v_Position;

void main() {
  v_Uv = a_Uv;
  v_Position = 0.5 * (a_Position + vec4(1.0, 1.0, 1.0, 1.0));
  gl_Position = u_ModelViewProjectionMatrix * a_Position;
} 
`},fragment:{glsl:`
uniform samplerCube u_Texture;
in vec2 v_Uv;
in vec4 v_Position;
out vec4 outputColor;

void main() {
  vec3 cubemapVec = v_Position.xyz - vec3(0.5);
  outputColor = texture(SAMPLER_Cube(u_Texture), cubemapVec);
}
`}}),o=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),l=n.createBuffer({viewOrSize:16*4,usage:M.UNIFORM,hint:K.DYNAMIC}),u=await Promise.all(["/images/posx.jpg","/images/negx.jpg","/images/posy.jpg","/images/negy.jpg","/images/posz.jpg","/images/negz.jpg"].map(async N=>Rr(N))),a=n.createTexture({format:h.U8_RGBA_NORM,width:u[0].width,height:u[0].height,depthOrArrayLayers:6,dimension:P.TEXTURE_CUBE_MAP,usage:x.SAMPLED});a.setImageData(u),n.setResourceName(a,"Cube map");const _=n.createSampler({addressModeU:re.CLAMP_TO_EDGE,addressModeV:re.CLAMP_TO_EDGE,minFilter:Y.BILINEAR,magFilter:Y.BILINEAR,mipmapFilter:q.LINEAR,lodMinClamp:0,lodMaxClamp:0}),E=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:bt,format:h.F32_RGBA},{shaderLocation:1,offset:dr,format:h.F32_RG}]}],indexBufferFormat:null,program:s}),R=n.createRenderPipeline({inputLayout:E,program:s,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.NONE,stencilWrite:!1}}),d=n.createBindings({pipeline:R,uniformBufferBindings:[{binding:0,buffer:l}],samplerBindings:[{texture:a,sampler:_}]}),f=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),p=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET}));let T;const A=Or(v(),J(1e3,1e3,1e3)),m=v(),g=Ze(v()),B=v(),C=()=>{const N=t.width/t.height,V=Fe(v(),2*Math.PI/5,N,1,3e3),y=Date.now()/800;Se(B,g,Math.PI/10*Math.sin(y),J(1,0,0)),Se(B,B,y*.2,J(0,1,0)),ue(m,B,A),ue(m,V,m),l.setSubData(0,new Uint8Array(m.buffer)),s.setUniformsLegacy({u_ModelViewProjectionMatrix:m,u_Texture:a});const U=i.getOnscreenTexture(),L=n.createRenderPass({colorAttachment:[f],colorResolveTo:[U],colorClearColor:[ie],depthStencilAttachment:p,depthClearValue:1});L.setPipeline(R),L.setVertexInput(E,[{buffer:o}],null),L.setViewport(0,0,t.width,t.height),L.setBindings(d),L.draw(me,1,0,0),n.submitPass(L),T=requestAnimationFrame(C)};return C(),()=>{T&&cancelAnimationFrame(T),s.destroy(),o.destroy(),l.destroy(),E.destroy(),d.destroy(),R.destroy(),f.destroy(),p.destroy(),a.destroy(),_.destroy(),n.destroy(),n.checkForLeaks()}}async function Yn(e){return ne(e,Ln,{targets:["webgl1","webgl2","webgpu"],default:"webgl2"})}async function Kn(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice();n.createProgram({compute:{wgsl:`
`}});const s=n.createProgram({compute:{wgsl:`
      @binding(0) @group(0) var<storage, read_write> input : array<i32>;
      @binding(1) @group(0) var<storage, read_write> output : array<i32>;
      
      @compute @workgroup_size(8, 8)
      fn main(
        @builtin(global_invocation_id) global_id : vec3<u32>
      ) {
        var index = global_id.x;
        output[index] = input[index] + output[index];
      }
      `}}),o=n.createBuffer({usage:M.STORAGE|M.COPY_SRC,viewOrSize:new Int32Array([1,2,3,4])}),l=n.createBuffer({usage:M.STORAGE|M.COPY_SRC,viewOrSize:new Int32Array([1,2,3,4])}),u=n.createComputePipeline({inputLayout:null,program:s}),a=n.createBindings({pipeline:u,storageBufferBindings:[{binding:0,buffer:o},{binding:1,buffer:l}]}),_=n.createComputePass();_.setPipeline(u),_.setBindings(a),_.dispatchWorkgroups(1),n.submitPass(_);const R=await n.createReadback().readBuffer(l);return console.log(R),()=>{s.destroy(),n.destroy(),n.checkForLeaks()}}async function zn(e){return ne(e,Kn,{targets:["webgpu"],default:"webgpu"})}async function $n(e,t,r=!0){const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.createProgram({vertex:{entryPoint:"vert_main",wgsl:`
  struct VertexOutput {
    @builtin(position) position : vec4<f32>,
    @location(4) color : vec4<f32>,
  }

  @vertex
  fn vert_main(
    @location(0) a_particlePos : vec2<f32>,
    @location(1) a_particleVel : vec2<f32>,
    @location(2) a_pos : vec2<f32>
  ) -> VertexOutput {
    let angle = -atan2(a_particleVel.x, a_particleVel.y);
    let pos = vec2(
      (a_pos.x * cos(angle)) - (a_pos.y * sin(angle)),
      (a_pos.x * sin(angle)) + (a_pos.y * cos(angle))
    );

    var output : VertexOutput;
    output.position = vec4(pos + a_particlePos, 0.0, 1.0);
    output.color = vec4(
      1.0 - sin(angle + 1.0) - a_particleVel.y,
      pos.x * 100.0 - a_particleVel.y + 0.1,
      a_particleVel.x + cos(angle + 0.5),
      1.0);
    return output;
  }
  `},fragment:{entryPoint:"frag_main",wgsl:`
  @fragment
  fn frag_main(@location(4) color : vec4<f32>) -> @location(0) vec4<f32> {
    return color;
  }
  `}}),o=n.createProgram({compute:{wgsl:`
struct Particle {
  pos : vec2<f32>,
  vel : vec2<f32>,
}
struct SimParams {
  deltaT : f32,
  rule1Distance : f32,
  rule2Distance : f32,
  rule3Distance : f32,
  rule1Scale : f32,
  rule2Scale : f32,
  rule3Scale : f32,
}
struct Particles {
  particles : array<Particle>,
}
@binding(0) @group(0) var<uniform> params : SimParams;
@binding(1) @group(0) var<storage, read> particlesA : Particles;
@binding(2) @group(0) var<storage, read_write> particlesB : Particles;

// https://github.com/austinEng/Project6-Vulkan-Flocking/blob/master/data/shaders/computeparticles/particle.comp
@compute @workgroup_size(64)
fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {
  var index = GlobalInvocationID.x;

  var vPos = particlesA.particles[index].pos;
  var vVel = particlesA.particles[index].vel;
  var cMass = vec2(0.0);
  var cVel = vec2(0.0);
  var colVel = vec2(0.0);
  var cMassCount = 0u;
  var cVelCount = 0u;
  var pos : vec2<f32>;
  var vel : vec2<f32>;

  for (var i = 0u; i < arrayLength(&particlesA.particles); i++) {
    if (i == index) {
      continue;
    }

    pos = particlesA.particles[i].pos.xy;
    vel = particlesA.particles[i].vel.xy;
    if (distance(pos, vPos) < params.rule1Distance) {
      cMass += pos;
      cMassCount++;
    }
    if (distance(pos, vPos) < params.rule2Distance) {
      colVel -= pos - vPos;
    }
    if (distance(pos, vPos) < params.rule3Distance) {
      cVel += vel;
      cVelCount++;
    }
  }
  if (cMassCount > 0) {
    cMass = (cMass / vec2(f32(cMassCount))) - vPos;
  }
  if (cVelCount > 0) {
    cVel /= f32(cVelCount);
  }
  vVel += (cMass * params.rule1Scale) + (colVel * params.rule2Scale) + (cVel * params.rule3Scale);

  // clamp velocity for a more pleasing simulation
  vVel = normalize(vVel) * clamp(length(vVel), 0.0, 0.1);
  // kinematic update
  vPos = vPos + (vVel * params.deltaT);
  // Wrap around boundary
  if (vPos.x < -1.0) {
    vPos.x = 1.0;
  }
  if (vPos.x > 1.0) {
    vPos.x = -1.0;
  }
  if (vPos.y < -1.0) {
    vPos.y = 1.0;
  }
  if (vPos.y > 1.0) {
    vPos.y = -1.0;
  }
  // Write back
  particlesB.particles[index].pos = vPos;
  particlesB.particles[index].vel = vVel;
}
`}}),l=1500,u=new Float32Array(l*4);for(let N=0;N<l;++N)u[4*N+0]=2*(Math.random()-.5),u[4*N+1]=2*(Math.random()-.5),u[4*N+2]=2*(Math.random()-.5)*.1,u[4*N+3]=2*(Math.random()-.5)*.1;const a=[];for(let N=0;N<2;++N)a[N]=n.createBuffer({viewOrSize:u,usage:M.VERTEX|M.STORAGE});const _=new Float32Array([-.01,-.02,.01,-.02,0,.02]),E=n.createBuffer({viewOrSize:_,usage:M.VERTEX}),R=n.createBuffer({viewOrSize:7*Float32Array.BYTES_PER_ELEMENT,usage:M.UNIFORM}),d=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*4,stepMode:$.INSTANCE,attributes:[{shaderLocation:0,offset:0,format:h.F32_RG},{shaderLocation:1,offset:4*2,format:h.F32_RG}]},{arrayStride:4*2,stepMode:$.VERTEX,attributes:[{shaderLocation:2,offset:0,format:h.F32_RG}]}],indexBufferFormat:null,program:s}),f=n.createRenderPipeline({inputLayout:d,program:s,colorAttachmentFormats:[h.U8_RGBA_RT]}),p=n.createComputePipeline({inputLayout:null,program:o}),T={deltaT:.04,rule1Distance:.1,rule2Distance:.025,rule3Distance:.025,rule1Scale:.02,rule2Scale:.05,rule3Scale:.005},A=[];for(let N=0;N<2;++N)A[N]=n.createBindings({pipeline:p,uniformBufferBindings:[{binding:0,buffer:R}],storageBufferBindings:[{binding:1,buffer:a[N]},{binding:2,buffer:a[(N+1)%2]}]});const m=n.createRenderTarget({format:h.U8_RGBA_RT,width:t.width,height:t.height});n.setResourceName(m,"Main Render Target"),R.setSubData(0,new Uint8Array(new Float32Array([T.deltaT,T.rule1Distance,T.rule2Distance,T.rule3Distance,T.rule1Scale,T.rule2Scale,T.rule3Scale]).buffer));let g,B=0;const C=()=>{const N=n.createComputePass();N.setPipeline(p),N.setBindings(A[B%2]),N.dispatchWorkgroups(Math.ceil(l/64)),n.submitPass(N);const V=i.getOnscreenTexture(),y=n.createRenderPass({colorAttachment:[m],colorResolveTo:[V],colorClearColor:[ie]});y.setPipeline(f),y.setVertexInput(d,[{buffer:a[(B+1)%2]},{buffer:E}],null),y.setViewport(0,0,t.width,t.height),y.draw(3,l),n.submitPass(y),++B,g=requestAnimationFrame(C)};return C(),()=>{r&&g&&cancelAnimationFrame(g),s.destroy(),o.destroy(),a.forEach(N=>N.destroy()),R.destroy(),E.destroy(),d.destroy(),f.destroy(),p.destroy(),m.destroy(),n.destroy(),n.checkForLeaks()}}async function jn(e){return ne(e,$n,{targets:["webgpu"],default:"webgpu"})}async function qn(e,t,r=!0){var T;const i=await e.createSwapChain(t);i.configureSwapChain(t.width,t.height);const n=i.getDevice(),s=n.gl,o=n.createProgram({vertex:{glsl:`
layout(std140) uniform Uniforms {
  mat4 u_ModelViewProjectionMatrix;
};

layout(location = 0) in vec3 a_Position;

out vec4 v_Position;

void main() {
  v_Position = vec4(a_Position, 1.0);
  gl_Position = u_ModelViewProjectionMatrix * vec4(a_Position, 1.0);
} 
`},fragment:{glsl:`
in vec4 v_Position;
out vec4 outputColor;

void main() {
  outputColor = v_Position;
}
`}}),l=n.createBuffer({viewOrSize:Oe,usage:M.VERTEX}),u=n.createBuffer({viewOrSize:16*4,usage:M.UNIFORM,hint:K.DYNAMIC}),a=n.createInputLayout({vertexBufferDescriptors:[{arrayStride:Me,stepMode:$.VERTEX,attributes:[{shaderLocation:0,offset:0,format:h.F32_RGB}]}],indexBufferFormat:null,program:o}),_=n.createRenderPipeline({inputLayout:a,program:o,colorAttachmentFormats:[h.U8_RGBA_RT],depthStencilAttachmentFormat:h.D24_S8,megaStateDescriptor:{attachmentsState:[{channelWriteMask:H.ALL,rgbBlendState:{blendMode:X.ADD,blendSrcFactor:O.SRC_ALPHA,blendDstFactor:O.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:X.ADD,blendSrcFactor:O.ONE,blendDstFactor:O.ONE_MINUS_SRC_ALPHA}}],blendConstant:de,depthWrite:!0,depthCompare:w.LESS,cullMode:Z.BACK,stencilWrite:!1}}),E=n.createBindings({pipeline:_,uniformBufferBindings:[{binding:0,buffer:u,size:16*4}]}),R=n.createRenderTargetFromTexture(n.createTexture({format:h.U8_RGBA_RT,width:t.width,height:t.height,usage:x.RENDER_TARGET})),d=n.createRenderTargetFromTexture(n.createTexture({format:h.D24_S8,width:t.width,height:t.height,usage:x.RENDER_TARGET})),f=async()=>{const A=await navigator.xr.requestSession("immersive-ar");A.updateRenderState({baseLayer:new XRWebGLLayer(A,s)});const m=await A.requestReferenceSpace("local"),g=v(),B=(C,N)=>{A.requestAnimationFrame(B),s.bindFramebuffer(s.FRAMEBUFFER,A.renderState.baseLayer.framebuffer);const V=N.getViewerPose(m);if(V){const y=V.views[0];A.renderState.baseLayer.getViewport(y);const U=y.transform.matrix,L=y.projectionMatrix;ue(g,L,U),u.setSubData(0,new Uint8Array(g.buffer)),o.setUniformsLegacy({u_ModelViewProjectionMatrix:g});const se=i.getOnscreenTexture(),j=n.createRenderPass({colorAttachment:[R],colorResolveTo:[se],colorClearColor:[ie],depthStencilAttachment:d,depthClearValue:1});j.setPipeline(_),j.setVertexInput(a,[{buffer:l}],null),j.setViewport(0,0,t.width,t.height),j.setBindings(E),j.draw(me),n.submitPass(j)}};A.requestAnimationFrame(B)},p=document.createElement("button");return p.innerHTML="Start Hello WebXR",p.onclick=f,(T=t.parentElement)==null||T.appendChild(p),()=>{n.destroy(),n.checkForLeaks()}}async function Qn(e){return ne(e,qn,{targets:["webgl1","webgl2"],xrCompatible:!0,default:"webgl2"})}const Ft=Object.freeze(Object.defineProperty({__proto__:null,AR:Qn,Add2Vectors:zn,ComputeBoids:jn,Cubemap:Yn,DrawIndex:In,InstancedCubes:kn,MSAA:On,PrimitiveTopologyPoints:mn,PrimitiveTopologyTriangles:Nn,RotatingCube:Fn,Sampler:Wn,Scissor:xn,Stencil:Dn,TexturedCube:Xn,TwoCubes:yn},Symbol.toStringTag,{value:"Module"})),Ce=document.createElement("select");Ce.id="example-select";Ce.style.margin="1em";Ce.onchange=Jn;Ce.style.display="block";document.body.append(Ce);const Zn=Object.keys(Ft).map(e=>{const t=document.createElement("option");return t.textContent=e,t.value=e,t});Zn.forEach(e=>Ce.append(e));const Zt=new URL(location).searchParams.get("name");Ft[Zt]&&(Ce.value=Zt);const Jt=document.getElementById("container");let pt;Ar();async function Ar(){pt&&pt(),Jt.innerHTML="";const e=Ft[Ce.value];pt=await e(Jt)}function Jn(){const{value:e}=Ce;history.pushState({value:e},"",`?name=${e}`),Ar()}
